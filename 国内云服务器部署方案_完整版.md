# ðŸš€ å›½å†…äº‘æœåŠ¡å™¨éƒ¨ç½²æ–¹æ¡ˆï¼ˆå®Œæ•´ç‰ˆï¼‰

## ðŸ“‹ æ–¹æ¡ˆæ¦‚è¿°

ä½¿ç”¨å›½å†…äº‘æœåŠ¡å™¨ï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘ï¼‰éƒ¨ç½²ï¼Œç¡®ä¿ï¼š
- âœ… 24/7 ç¨³å®šè¿è¡Œï¼ˆä¸ä¼š sleepï¼‰
- âœ… å›½å†…è®¿é—®é€Ÿåº¦å¿«
- âœ… ä¸“ä¸šå¯é ï¼Œé€‚åˆç»™è€æ¿å±•ç¤º
- âœ… ä»·æ ¼ä¾¿å®œï¼ˆÂ¥24-50/æœˆï¼‰

---

## ðŸŽ¯ ç¬¬ä¸€æ­¥ï¼šè´­ä¹°äº‘æœåŠ¡å™¨

### æŽ¨èæœåŠ¡å•†å¯¹æ¯”

| æœåŠ¡å•† | ä»·æ ¼ | é…ç½® | æŽ¨èåº¦ |
|--------|------|------|--------|
| **é˜¿é‡Œäº‘è½»é‡æœåŠ¡å™¨** | Â¥24/æœˆèµ· | 2æ ¸2Gï¼Œ3Må¸¦å®½ | â­â­â­â­â­ |
| **è…¾è®¯äº‘è½»é‡æœåŠ¡å™¨** | Â¥24/æœˆèµ· | 2æ ¸2Gï¼Œ3Må¸¦å®½ | â­â­â­â­â­ |
| **åŽä¸ºäº‘** | Â¥30/æœˆèµ· | 2æ ¸2Gï¼Œ3Må¸¦å®½ | â­â­â­â­ |

### è´­ä¹°æ­¥éª¤ï¼ˆä»¥é˜¿é‡Œäº‘ä¸ºä¾‹ï¼‰

1. **è®¿é—®é˜¿é‡Œäº‘**
   - æ‰“å¼€ï¼šhttps://www.aliyun.com
   - æ³¨å†Œ/ç™»å½•è´¦å·

2. **é€‰æ‹©è½»é‡åº”ç”¨æœåŠ¡å™¨**
   - é¦–é¡µ â†’ äº§å“ â†’ è½»é‡åº”ç”¨æœåŠ¡å™¨
   - æˆ–ç›´æŽ¥è®¿é—®ï¼šhttps://www.aliyun.com/product/swas

3. **é€‰æ‹©é…ç½®**
   - **åœ°åŸŸ**ï¼šé€‰æ‹©ç¦»ä½ æœ€è¿‘çš„ï¼ˆå¦‚ï¼šåŽä¸œ1-æ­å·žï¼‰
   - **é•œåƒ**ï¼šé€‰æ‹© `Ubuntu 22.04` æˆ– `Ubuntu 20.04`
   - **å¥—é¤**ï¼šé€‰æ‹© `2æ ¸2Gï¼Œ3Må¸¦å®½`ï¼ˆÂ¥24/æœˆï¼‰
   - **è´­ä¹°æ—¶é•¿**ï¼šå»ºè®®å…ˆä¹°1ä¸ªæœˆæµ‹è¯•

4. **è®¾ç½®å¯†ç **
   - è®¾ç½® root å¯†ç ï¼ˆè®°ä½è¿™ä¸ªå¯†ç ï¼ï¼‰
   - æˆ–ä½¿ç”¨ SSH å¯†é’¥ï¼ˆæŽ¨èï¼‰

5. **å®Œæˆè´­ä¹°**
   - æ”¯ä»˜åŽç­‰å¾… 1-2 åˆ†é’Ÿ
   - æœåŠ¡å™¨ä¼šè‡ªåŠ¨åˆ›å»º

6. **èŽ·å–æœåŠ¡å™¨ä¿¡æ¯**
   - åœ¨æŽ§åˆ¶å°æ‰¾åˆ°ä½ çš„æœåŠ¡å™¨
   - è®°å½•ï¼š**å…¬ç½‘IPåœ°å€**ï¼ˆé‡è¦ï¼ï¼‰

---

## ðŸ”§ ç¬¬äºŒæ­¥ï¼šè¿žæŽ¥æœåŠ¡å™¨

### Windows è¿žæŽ¥æ–¹æ³•

#### æ–¹æ³•1ï¼šä½¿ç”¨ PowerShellï¼ˆæŽ¨èï¼‰

```powershell
# åœ¨ PowerShell ä¸­æ‰§è¡Œ
# æ›¿æ¢ ä½ çš„æœåŠ¡å™¨IP ä¸ºå®žé™…IP
ssh root@ä½ çš„æœåŠ¡å™¨IP
```

**é¦–æ¬¡è¿žæŽ¥ä¼šæç¤ºç¡®è®¤ï¼Œè¾“å…¥ `yes`**

#### æ–¹æ³•2ï¼šä½¿ç”¨ PuTTY

1. ä¸‹è½½ PuTTYï¼šhttps://www.putty.org
2. æ‰“å¼€ PuTTY
3. Host Name: è¾“å…¥æœåŠ¡å™¨IP
4. Port: 22
5. Connection type: SSH
6. ç‚¹å‡» "Open"
7. è¾“å…¥ç”¨æˆ·åï¼š`root`
8. è¾“å…¥å¯†ç ï¼ˆè´­ä¹°æ—¶è®¾ç½®çš„ï¼‰

---

## ðŸ“¦ ç¬¬ä¸‰æ­¥ï¼šå®‰è£…ç³»ç»Ÿä¾èµ–

è¿žæŽ¥æœåŠ¡å™¨åŽï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# 1. æ›´æ–°ç³»ç»Ÿ
apt update && apt upgrade -y

# 2. å®‰è£… Python 3.11
apt install software-properties-common -y
add-apt-repository ppa:deadsnakes/ppa -y
apt update
apt install python3.11 python3.11-venv python3.11-dev python3-pip git -y

# 3. å®‰è£…ç³»ç»Ÿä¾èµ–ï¼ˆOpenCV éœ€è¦ï¼‰
apt install libgl1-mesa-glx libglib2.0-0 libsm6 libxext6 libxrender-dev -y

# 4. éªŒè¯å®‰è£…
python3.11 --version
# åº”è¯¥æ˜¾ç¤ºï¼šPython 3.11.x
```

---

## ðŸ“¥ ç¬¬å››æ­¥ï¼šå…‹éš†é¡¹ç›®

```bash
# 1. è¿›å…¥ /opt ç›®å½•
cd /opt

# 2. å…‹éš†é¡¹ç›®
git clone https://github.com/Andylee56-cyber/drone-material-generator.git

# 3. è¿›å…¥é¡¹ç›®ç›®å½•
cd drone-material-generator

# 4. æŸ¥çœ‹æ–‡ä»¶
ls -la
```

---

## ðŸ ç¬¬äº”æ­¥ï¼šåˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒå¹¶å®‰è£…ä¾èµ–

```bash
# 1. åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒ
python3.11 -m venv venv

# 2. æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒ
source venv/bin/activate

# 3. å‡çº§ pip
pip install --upgrade pip

# 4. å®‰è£…ä¾èµ–ï¼ˆä½¿ç”¨å›½å†…é•œåƒï¼Œé€Ÿåº¦å¿«ï¼‰
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

# 5. éªŒè¯å®‰è£…
python -c "import streamlit, cv2, torch; print('âœ… æ‰€æœ‰ä¾èµ–å®‰è£…æˆåŠŸ')"
```

**æ³¨æ„**ï¼šå®‰è£…è¿‡ç¨‹å¯èƒ½éœ€è¦ 5-10 åˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚

---

## âš™ï¸ ç¬¬å…­æ­¥ï¼šé…ç½® Streamlit

```bash
# 1. åˆ›å»ºé…ç½®ç›®å½•
mkdir -p ~/.streamlit

# 2. åˆ›å»ºé…ç½®æ–‡ä»¶
cat > ~/.streamlit/config.toml << 'EOF'
[server]
port = 8501
address = "0.0.0.0"
headless = true
enableCORS = false
enableXsrfProtection = true
maxUploadSize = 200

[browser]
gatherUsageStats = false

[theme]
primaryColor = "#1f77b4"
backgroundColor = "#ffffff"
secondaryBackgroundColor = "#f0f2f6"
textColor = "#262730"
font = "sans serif"
EOF

# 3. éªŒè¯é…ç½®
cat ~/.streamlit/config.toml
```

---

## ðŸ”¥ ç¬¬ä¸ƒæ­¥ï¼šé…ç½®é˜²ç«å¢™

```bash
# 1. æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€
ufw status

# 2. å¼€æ”¾ 8501 ç«¯å£
ufw allow 8501/tcp

# 3. å¦‚æžœé˜²ç«å¢™æœªå¯ç”¨ï¼Œå¯ç”¨å®ƒ
ufw enable

# 4. ç¡®è®¤ç«¯å£å·²å¼€æ”¾
ufw status
# åº”è¯¥çœ‹åˆ°ï¼š8501/tcp ALLOW Anywhere
```

---

## ðŸš€ ç¬¬å…«æ­¥ï¼šåˆ›å»ºç³»ç»ŸæœåŠ¡ï¼ˆç¡®ä¿ 24/7 è¿è¡Œï¼‰

```bash
# 1. åˆ›å»ºæœåŠ¡æ–‡ä»¶
sudo cat > /etc/systemd/system/streamlit-app.service << 'EOF'
[Unit]
Description=Streamlit Drone Material Generator App
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/drone-material-generator
Environment="PATH=/opt/drone-material-generator/venv/bin"
ExecStart=/opt/drone-material-generator/venv/bin/streamlit run app/web/material_generator_app.py --server.port 8501 --server.address 0.0.0.0
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
EOF

# 2. é‡æ–°åŠ è½½ systemd
sudo systemctl daemon-reload

# 3. å¯ç”¨æœåŠ¡ï¼ˆå¼€æœºè‡ªå¯ï¼‰
sudo systemctl enable streamlit-app

# 4. å¯åŠ¨æœåŠ¡
sudo systemctl start streamlit-app

# 5. æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status streamlit-app
# åº”è¯¥æ˜¾ç¤ºï¼šactive (running)
```

---

## âœ… ç¬¬ä¹æ­¥ï¼šéªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status streamlit-app

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
sudo journalctl -u streamlit-app -f
```

### 2. æµ‹è¯•è®¿é—®

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
```
http://ä½ çš„æœåŠ¡å™¨IP:8501
```

**ä¾‹å¦‚**ï¼šå¦‚æžœæœåŠ¡å™¨IPæ˜¯ `123.456.789.012`ï¼Œåˆ™è®¿é—®ï¼š
```
http://123.456.789.012:8501
```

### 3. æµ‹è¯•åŠŸèƒ½

- [ ] é¡µé¢å¯ä»¥æ­£å¸¸åŠ è½½
- [ ] å¯ä»¥ä¸Šä¼ å›¾ç‰‡
- [ ] å¯ä»¥ç”Ÿæˆç´ æ
- [ ] å¢žå¼ºè®­ç»ƒåŠŸèƒ½æ­£å¸¸

---

## ðŸ”§ å¸¸ç”¨ç®¡ç†å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
sudo systemctl status streamlit-app
```

### æŸ¥çœ‹æœåŠ¡æ—¥å¿—
```bash
sudo journalctl -u streamlit-app -f
```

### é‡å¯æœåŠ¡
```bash
sudo systemctl restart streamlit-app
```

### åœæ­¢æœåŠ¡
```bash
sudo systemctl stop streamlit-app
```

### å¯åŠ¨æœåŠ¡
```bash
sudo systemctl start streamlit-app
```

### æ›´æ–°ä»£ç 
```bash
cd /opt/drone-material-generator
git pull origin main
source venv/bin/activate
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
sudo systemctl restart streamlit-app
```

---

## ðŸŒ ç¬¬åæ­¥ï¼šé…ç½®åŸŸåï¼ˆå¯é€‰ï¼‰

å¦‚æžœéœ€è¦ä½¿ç”¨åŸŸåè®¿é—®ï¼š

### 1. è´­ä¹°åŸŸå

- é˜¿é‡Œäº‘åŸŸåï¼šhttps://wanwang.aliyun.com
- è…¾è®¯äº‘åŸŸåï¼šhttps://dnspod.cloud.tencent.com

### 2. è§£æžåŸŸå

1. ç™»å½•åŸŸåç®¡ç†æŽ§åˆ¶å°
2. æ·»åŠ  A è®°å½•ï¼š
   - ä¸»æœºè®°å½•ï¼š`@` æˆ– `www`
   - è®°å½•å€¼ï¼šä½ çš„æœåŠ¡å™¨IP
   - TTLï¼š600

### 3. é…ç½® Nginx åå‘ä»£ç†ï¼ˆæŽ¨èï¼‰

```bash
# 1. å®‰è£… Nginx
apt install nginx -y

# 2. åˆ›å»º Nginx é…ç½®
sudo cat > /etc/nginx/sites-available/streamlit << 'EOF'
server {
    listen 80;
    server_name ä½ çš„åŸŸå.com;

    location / {
        proxy_pass http://127.0.0.1:8501;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
EOF

# 3. åˆ›å»ºè½¯é“¾æŽ¥
sudo ln -s /etc/nginx/sites-available/streamlit /etc/nginx/sites-enabled/

# 4. æµ‹è¯•é…ç½®
sudo nginx -t

# 5. é‡å¯ Nginx
sudo systemctl restart nginx
```

### 4. é…ç½® SSL è¯ä¹¦ï¼ˆHTTPSï¼Œå¯é€‰ï¼‰

```bash
# å®‰è£… Certbot
apt install certbot python3-certbot-nginx -y

# ç”³è¯·è¯ä¹¦
sudo certbot --nginx -d ä½ çš„åŸŸå.com

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

---

## ðŸ› å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1ï¼šæ— æ³•è¿žæŽ¥æœåŠ¡å™¨

**è§£å†³**ï¼š
- æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
- æ£€æŸ¥å®‰å…¨ç»„æ˜¯å¦å¼€æ”¾ 22 ç«¯å£ï¼ˆSSHï¼‰
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### é—®é¢˜2ï¼šç«¯å£ 8501 æ— æ³•è®¿é—®

**è§£å†³**ï¼š
```bash
# 1. æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ
sudo systemctl status streamlit-app

# 2. æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
netstat -tlnp | grep 8501

# 3. æ£€æŸ¥é˜²ç«å¢™
ufw status

# 4. æ£€æŸ¥äº‘æœåŠ¡å™¨å®‰å…¨ç»„
# åœ¨é˜¿é‡Œäº‘æŽ§åˆ¶å° â†’ å®‰å…¨ç»„ â†’ æ·»åŠ è§„åˆ™ï¼šå¼€æ”¾ 8501 ç«¯å£
```

### é—®é¢˜3ï¼šOpenCV å¯¼å…¥é”™è¯¯

**è§£å†³**ï¼š
```bash
# ç¡®ä¿å®‰è£…äº†ç³»ç»Ÿä¾èµ–
apt install libgl1-mesa-glx libglib2.0-0 -y

# é‡æ–°å®‰è£… opencv
source venv/bin/activate
pip uninstall opencv-python-headless -y
pip install opencv-python-headless -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### é—®é¢˜4ï¼šæœåŠ¡å¯åŠ¨å¤±è´¥

**è§£å†³**ï¼š
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
sudo journalctl -u streamlit-app -n 50

# æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
ls -la /opt/drone-material-generator/app/web/material_generator_app.py

# æ£€æŸ¥ Python è·¯å¾„
which python
# åº”è¯¥æ˜¾ç¤ºï¼š/opt/drone-material-generator/venv/bin/python
```

---

## ðŸ“ éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] æœåŠ¡å™¨å·²è´­ä¹°å¹¶è¿è¡Œ
- [ ] å¯ä»¥ SSH è¿žæŽ¥æœåŠ¡å™¨
- [ ] Python 3.11 å·²å®‰è£…
- [ ] é¡¹ç›®å·²å…‹éš†åˆ°æœåŠ¡å™¨
- [ ] è™šæ‹ŸçŽ¯å¢ƒå·²åˆ›å»º
- [ ] æ‰€æœ‰ä¾èµ–å·²å®‰è£…
- [ ] Streamlit é…ç½®å·²åˆ›å»º
- [ ] é˜²ç«å¢™å·²å¼€æ”¾ 8501 ç«¯å£
- [ ] ç³»ç»ŸæœåŠ¡å·²åˆ›å»ºå¹¶å¯åŠ¨
- [ ] å¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—®åº”ç”¨
- [ ] æ‰€æœ‰åŠŸèƒ½æµ‹è¯•æ­£å¸¸

---

## ðŸŽ‰ å®Œæˆï¼

éƒ¨ç½²æˆåŠŸåŽï¼š
- âœ… åº”ç”¨ 24/7 è¿è¡Œï¼ˆä¸ä¼š sleepï¼‰
- âœ… å¯ä»¥é€šè¿‡ IP æˆ–åŸŸåè®¿é—®
- âœ… å›½å†…è®¿é—®é€Ÿåº¦å¿«
- âœ… é€‚åˆç»™è€æ¿å±•ç¤º

**è®¿é—®åœ°å€**ï¼š`http://ä½ çš„æœåŠ¡å™¨IP:8501`

---

## ðŸ’° è´¹ç”¨è¯´æ˜Ž

- **æœåŠ¡å™¨è´¹ç”¨**ï¼šÂ¥24-50/æœˆ
- **åŸŸåè´¹ç”¨**ï¼ˆå¯é€‰ï¼‰ï¼šÂ¥55/å¹´èµ·
- **æ€»è®¡**ï¼šçº¦ Â¥24-50/æœˆï¼ˆä¸å«åŸŸåï¼‰

---

## ðŸ“ž éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æžœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹æœåŠ¡æ—¥å¿—ï¼š`sudo journalctl -u streamlit-app -f`
2. æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š`sudo systemctl status streamlit-app`
3. æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼Œå‘Šè¯‰æˆ‘å…·ä½“é—®é¢˜

