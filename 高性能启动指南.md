# 🚀 高性能启动指南（恢复GPU加速）

## 📋 第一步：安装依赖

在PowerShell中执行：

```powershell
cd d:\mlflow_learning_project
.\安装依赖.ps1
```

或者手动安装：

```powershell
# 基础依赖
pip install streamlit plotly pandas numpy Pillow opencv-python-headless scipy ultralytics

# PyTorch（根据你的系统选择）

# CPU版本（兼容性好）
pip install torch torchvision torchaudio

# GPU版本（需要NVIDIA显卡，速度快）
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
```

---

## 🚀 第二步：启动高性能版本

### 方法1：使用启动脚本（推荐）

```powershell
cd d:\mlflow_learning_project
.\高性能启动.ps1
```

### 方法2：直接命令启动

```powershell
cd d:\mlflow_learning_project
streamlit run material_generator_app_optimized.py --server.port 8501 --server.address 0.0.0.0
```

---

## ✅ 验证GPU加速

启动后，在浏览器中查看页面顶部，应该显示：
- **如果有GPU：** `🚀 GPU加速已启用: NVIDIA GeForce XXX`
- **如果没有GPU：** `💻 使用CPU模式（建议使用GPU以获得更好性能）`

---

## 📊 性能对比

| 配置 | 处理速度 | 适用场景 |
|------|---------|---------|
| **GPU加速** | ⚡⚡⚡ 极快 | 有NVIDIA显卡，演示效果最佳 |
| **CPU多线程** | ⚡⚡ 较快 | 无GPU，但有多核CPU |
| **CPU单线程** | ⚡ 较慢 | 低配置服务器（已移除） |

---

## 🎯 给老板演示

### 启动后访问：
- **本地：** `http://localhost:8501`
- **局域网：** `http://你的IP:8501`

### 查看你的IP：
```powershell
ipconfig | findstr IPv4
```

---

## 💡 优化说明

已恢复的高性能特性：
- ✅ **GPU自动检测和使用** - 如果有GPU会自动使用
- ✅ **多线程CPU加速** - CPU模式下使用4线程
- ✅ **模型缓存优化** - 模型只加载一次，后续复用
- ✅ **CUDA优化** - GPU模式下启用cuDNN benchmark
- ✅ **内存优化** - 推理时禁用梯度计算

已移除的低配置限制：
- ❌ CPU单线程限制（已移除）
- ❌ 强制CPU模式（已移除）
- ❌ 性能降级（已移除）

---

## 🛑 停止服务

按 `Ctrl + C` 停止

---

## ⚠️ 如果遇到问题

### 问题1：ModuleNotFoundError: No module named 'torch'
**解决：** 运行 `.\安装依赖.ps1`

### 问题2：CUDA不可用
**解决：** 
- 检查NVIDIA驱动是否安装
- 检查CUDA版本是否匹配
- 或使用CPU版本：`pip install torch torchvision torchaudio`

### 问题3：端口被占用
**解决：** 换其他端口
```powershell
streamlit run material_generator_app_optimized.py --server.port 8502 --server.address 0.0.0.0
```

---

## 🎉 完成！

现在系统已恢复高性能配置，可以流畅演示给老板看了！

