# ç¬¬7-8å‘¨ï¼šå¤šä»»åŠ¡ç®—æ³•é›†æˆç³»ç»Ÿ - å®Œæ•´å®æ–½æ–¹æ¡ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬æ–¹æ¡ˆæ—¨åœ¨æ„å»ºä¸€ä¸ª**ä¼ä¸šçº§æ— äººæœºè§†è§‰æ™ºèƒ½åˆ†æç³»ç»Ÿ**ï¼Œé›†æˆè¯­ä¹‰åˆ†å‰²ã€ç›®æ ‡è·Ÿè¸ªã€å¤šä¼ æ„Ÿå™¨èåˆç­‰å‰æ²¿æŠ€æœ¯ï¼Œå®ç°é“è·¯ã€å†œç”°ç­‰å¤æ‚åœºæ™¯çš„æ™ºèƒ½è¯†åˆ«ä¸åˆ†æã€‚

---

## ğŸ¯ æ ¸å¿ƒä»»åŠ¡

### ä»»åŠ¡1ï¼šè¯­ä¹‰åˆ†å‰²ç®—æ³•å¼€å‘
- **é“è·¯è¯†åˆ«**ï¼šç‹­çª„é“è·¯ã€æ³¥æ³é“è·¯ã€æç«¯å¤©æ°”é“è·¯
- **å†œç”°è¯†åˆ«**ï¼šæ³¥æ³å†œç”°ã€å¹²æ—±å†œç”°ã€ä¸åŒä½œç‰©ç±»å‹
- **åœºæ™¯ç†è§£**ï¼šå¤šç±»åˆ«åˆ†å‰²ã€å®ä¾‹åˆ†å‰²

### ä»»åŠ¡2ï¼šç›®æ ‡è·Ÿè¸ªåŠŸèƒ½
- **å¤šç›®æ ‡è·Ÿè¸ª**ï¼šDeepSORTã€ByteTrack
- **è½¨è¿¹é¢„æµ‹**ï¼šå¡å°”æ›¼æ»¤æ³¢ã€LSTMé¢„æµ‹
- **é®æŒ¡å¤„ç†**ï¼šé‡è¯†åˆ«ã€è½¨è¿¹å…³è”

### ä»»åŠ¡3ï¼šå¤šä¼ æ„Ÿå™¨æ•°æ®èåˆ
- **å¤šå…‰è°±æ•°æ®å¤„ç†**ï¼šNDVIã€EVIæŒ‡æ•°è®¡ç®—
- **çº¢å¤–ä¼ æ„Ÿå™¨å¤„ç†**ï¼šçƒ­æˆåƒåˆ†æã€æ¸©åº¦å¼‚å¸¸æ£€æµ‹
- **æ•°æ®èåˆ**ï¼šRGB + å¤šå…‰è°± + çº¢å¤–èåˆ

### ä»»åŠ¡4ï¼šæ€§èƒ½åŸºå‡†æµ‹è¯•å¥—ä»¶
- **è¯„ä¼°æŒ‡æ ‡**ï¼šmIoUã€mAPã€FPSã€å‡†ç¡®ç‡
- **æµ‹è¯•æ•°æ®é›†**ï¼šæ ‡å‡†æ•°æ®é›† + è‡ªå®šä¹‰æ•°æ®é›†
- **æ€§èƒ½ç›‘æ§**ï¼šå®æ—¶æ€§èƒ½ç›‘æ§ã€æ—¥å¿—è®°å½•

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯å±•ç¤ºå±‚ (Frontend)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Streamlitâ”‚  â”‚ React Webâ”‚  â”‚ ç§»åŠ¨ç«¯App â”‚  â”‚ å¤§å±å±•ç¤º â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†• HTTP/WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    APIæœåŠ¡å±‚ (Backend API)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ FastAPI  â”‚  â”‚ WebSocketâ”‚  â”‚ RESTful  â”‚  â”‚ GraphQL â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†• gRPC/æ¶ˆæ¯é˜Ÿåˆ—
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ç®—æ³•æœåŠ¡å±‚ (Algorithm Services)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è¯­ä¹‰åˆ†å‰²æœåŠ¡ â”‚  â”‚ ç›®æ ‡è·Ÿè¸ªæœåŠ¡  â”‚  â”‚ ä¼ æ„Ÿå™¨èåˆæœåŠ¡â”‚  â”‚
â”‚  â”‚ (Segmentationâ”‚  â”‚ (Tracking)    â”‚  â”‚ (Fusion)     â”‚  â”‚
â”‚  â”‚  Service)    â”‚  â”‚              â”‚  â”‚              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ•°æ®å­˜å‚¨å±‚ (Data Storage)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ PostgreSQLâ”‚  â”‚ Redis   â”‚  â”‚ MinIO    â”‚  â”‚ MLflow â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’» æŠ€æœ¯æ ˆé€‰å‹

### å‰ç«¯æŠ€æœ¯æ ˆ

#### 1. Streamlitï¼ˆå¿«é€ŸåŸå‹ + ç®¡ç†ç•Œé¢ï¼‰
- **ç”¨é€”**ï¼šç®—æ³•é…ç½®ã€ç»“æœå¯è§†åŒ–ã€ç³»ç»Ÿç›‘æ§
- **ä¼˜åŠ¿**ï¼šå¿«é€Ÿå¼€å‘ã€PythonåŸç”Ÿã€é€‚åˆAIåº”ç”¨
- **ç»„ä»¶**ï¼š
  - `streamlit-option-menu`ï¼šå¯¼èˆªèœå•
  - `streamlit-aggrid`ï¼šé«˜çº§è¡¨æ ¼
  - `streamlit-plotly`ï¼šäº¤äº’å¼å›¾è¡¨
  - `streamlit-image-coordinates`ï¼šå›¾åƒæ ‡æ³¨

#### 2. React + TypeScriptï¼ˆä¼ä¸šçº§Webåº”ç”¨ï¼‰
- **æ¡†æ¶**ï¼šReact 18 + TypeScript 5
- **UIåº“**ï¼šAnt Design / Material-UI
- **çŠ¶æ€ç®¡ç†**ï¼šRedux Toolkit + RTK Query
- **å›¾è¡¨**ï¼šECharts / D3.js
- **åœ°å›¾**ï¼šMapbox GL / Leaflet
- **å®æ—¶é€šä¿¡**ï¼šSocket.io Client

#### 3. ç§»åŠ¨ç«¯ï¼ˆReact Native / Flutterï¼‰
- **æ¡†æ¶**ï¼šReact Nativeï¼ˆè·¨å¹³å°ï¼‰
- **åœ°å›¾**ï¼šReact Native Maps
- **ç›¸æœº**ï¼šreact-native-camera / expo-camera
- **å›¾è¡¨**ï¼šreact-native-chart-kit

#### 4. å¤§å±å±•ç¤ºï¼ˆVue 3 + EChartsï¼‰
- **æ¡†æ¶**ï¼šVue 3 + TypeScript
- **å¯è§†åŒ–**ï¼šECharts + DataV
- **3Dæ•ˆæœ**ï¼šThree.js

### åç«¯æŠ€æœ¯æ ˆ

#### 1. APIæœåŠ¡å±‚
- **FastAPI**ï¼šé«˜æ€§èƒ½å¼‚æ­¥APIæ¡†æ¶
  - è‡ªåŠ¨APIæ–‡æ¡£ï¼ˆSwagger/OpenAPIï¼‰
  - å¼‚æ­¥è¯·æ±‚å¤„ç†
  - æ•°æ®éªŒè¯ï¼ˆPydanticï¼‰
  - WebSocketæ”¯æŒ
- **gRPC**ï¼šé«˜æ€§èƒ½RPCæ¡†æ¶ï¼ˆç®—æ³•æœåŠ¡é—´é€šä¿¡ï¼‰
- **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šRabbitMQ / Apache Kafkaï¼ˆä»»åŠ¡é˜Ÿåˆ—ï¼‰

#### 2. ç®—æ³•æœåŠ¡å±‚
- **æ·±åº¦å­¦ä¹ æ¡†æ¶**ï¼š
  - PyTorch 2.0+ï¼ˆä¸»è¦æ¡†æ¶ï¼‰
  - TensorFlow 2.xï¼ˆéƒ¨åˆ†æ¨¡å‹ï¼‰
  - ONNX Runtimeï¼ˆæ¨¡å‹ä¼˜åŒ–ï¼‰
- **è¯­ä¹‰åˆ†å‰²æ¨¡å‹**ï¼š
  - DeepLabV3+ï¼ˆResNet50/101 backboneï¼‰
  - U-Net++ï¼ˆåŒ»å­¦å›¾åƒé£æ ¼ï¼‰
  - SegFormerï¼ˆTransformeræ¶æ„ï¼‰
  - BiSeNet V2ï¼ˆå®æ—¶åˆ†å‰²ï¼‰
- **ç›®æ ‡è·Ÿè¸ª**ï¼š
  - DeepSORTï¼ˆå¤šç›®æ ‡è·Ÿè¸ªï¼‰
  - ByteTrackï¼ˆé«˜æ€§èƒ½è·Ÿè¸ªï¼‰
  - FairMOTï¼ˆè”åˆæ£€æµ‹è·Ÿè¸ªï¼‰
- **ä¼ æ„Ÿå™¨å¤„ç†**ï¼š
  - Spectral Pythonï¼ˆå¤šå…‰è°±å¤„ç†ï¼‰
  - Rasterioï¼ˆåœ°ç†æ•°æ®å¤„ç†ï¼‰
  - GDALï¼ˆåœ°ç†ç©ºé—´æ•°æ®ï¼‰

#### 3. æ•°æ®å­˜å‚¨
- **PostgreSQL**ï¼šå…³ç³»å‹æ•°æ®åº“ï¼ˆå…ƒæ•°æ®ã€é…ç½®ï¼‰
- **Redis**ï¼šç¼“å­˜ã€ä¼šè¯å­˜å‚¨ã€ä»»åŠ¡é˜Ÿåˆ—
- **MinIO**ï¼šå¯¹è±¡å­˜å‚¨ï¼ˆå›¾ç‰‡ã€è§†é¢‘ã€æ¨¡å‹æ–‡ä»¶ï¼‰
- **MLflow**ï¼šå®éªŒè·Ÿè¸ªã€æ¨¡å‹ç‰ˆæœ¬ç®¡ç†
- **TimescaleDB**ï¼šæ—¶åºæ•°æ®ï¼ˆä¼ æ„Ÿå™¨æ•°æ®ï¼‰

#### 4. éƒ¨ç½²ä¸è¿ç»´
- **å®¹å™¨åŒ–**ï¼šDocker + Docker Compose
- **ç¼–æ’**ï¼šKubernetesï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- **CI/CD**ï¼šGitHub Actions / GitLab CI
- **ç›‘æ§**ï¼šPrometheus + Grafana
- **æ—¥å¿—**ï¼šELK Stackï¼ˆElasticsearch + Logstash + Kibanaï¼‰

---

## ğŸ§  ç®—æ³•è¯¦ç»†è®¾è®¡

### 1. è¯­ä¹‰åˆ†å‰²ç®—æ³• - é“è·¯è¯†åˆ«

#### 1.1 æŒ‘æˆ˜åœºæ™¯è®¾è®¡

##### ç‹­çª„é“è·¯è¯†åˆ«
- **ç‰¹å¾**ï¼šå®½åº¦ < 3ç±³ã€è¾¹ç¼˜æ¨¡ç³Šã€é®æŒ¡ä¸¥é‡
- **ç®—æ³•ç­–ç•¥**ï¼š
  - ä½¿ç”¨**æ³¨æ„åŠ›æœºåˆ¶**ï¼ˆCBAMã€SE-Netï¼‰å¢å¼ºè¾¹ç¼˜ç‰¹å¾
  - **å¤šå°ºåº¦ç‰¹å¾èåˆ**ï¼ˆFPNã€PANetï¼‰
  - **è¾¹ç•Œç»†åŒ–æ¨¡å—**ï¼ˆBoundary Refinement Moduleï¼‰
- **æ•°æ®å¢å¼º**ï¼š
  - éšæœºè£å‰ªï¼ˆæ¨¡æ‹Ÿç‹­çª„è§†è§’ï¼‰
  - é€è§†å˜æ¢ï¼ˆæ¨¡æ‹Ÿä¸åŒè§’åº¦ï¼‰
  - è¾¹ç¼˜å¢å¼ºï¼ˆæé«˜è¾¹ç•Œæ¸…æ™°åº¦ï¼‰

##### æ³¥æ³é“è·¯è¯†åˆ«
- **ç‰¹å¾**ï¼šé¢œè‰²ä¸å‘¨å›´ç¯å¢ƒç›¸ä¼¼ã€çº¹ç†å¤æ‚ã€åå°„å˜åŒ–å¤§
- **ç®—æ³•ç­–ç•¥**ï¼š
  - **å¤šæ¨¡æ€èåˆ**ï¼šRGB + æ·±åº¦ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰
  - **çº¹ç†åˆ†æ**ï¼šGaboræ»¤æ³¢å™¨ã€LBPç‰¹å¾
  - **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**ï¼šä½¿ç”¨**å…¨å±€ä¸Šä¸‹æ–‡æ¨¡å—**ï¼ˆPSPNetã€ASPPï¼‰
- **æ•°æ®å¢å¼º**ï¼š
  - é¢œè‰²æŠ–åŠ¨ï¼ˆæ¨¡æ‹Ÿä¸åŒå…‰ç…§ï¼‰
  - å™ªå£°æ·»åŠ ï¼ˆæ¨¡æ‹Ÿæ³¥æ³çº¹ç†ï¼‰
  - æ··åˆå¢å¼ºï¼ˆMixUpã€CutMixï¼‰

##### æç«¯å¤©æ°”é“è·¯è¯†åˆ«
- **åœºæ™¯**ï¼šé›¨é›ªã€é›¾éœ¾ã€å¤œé—´ã€å¼ºå…‰
- **ç®—æ³•ç­–ç•¥**ï¼š
  - **å›¾åƒé¢„å¤„ç†**ï¼š
    - å»é›¾ç®—æ³•ï¼ˆDehazeNetã€AOD-Netï¼‰
    - å»é›¨ç®—æ³•ï¼ˆDerainNetï¼‰
    - ä½å…‰ç…§å¢å¼ºï¼ˆRetinexã€Zero-DCEï¼‰
  - **åŸŸé€‚åº”**ï¼šå¯¹æŠ—è®­ç»ƒï¼ˆAdversarial Domain Adaptationï¼‰
  - **å¤šä»»åŠ¡å­¦ä¹ **ï¼šåŒæ—¶é¢„æµ‹å¤©æ°”ç±»å‹å’Œé“è·¯åˆ†å‰²
- **æ•°æ®å¢å¼º**ï¼š
  - å¤©æ°”æ¨¡æ‹Ÿï¼ˆæ·»åŠ é›¨é›ªæ•ˆæœï¼‰
  - å…‰ç…§å˜åŒ–ï¼ˆæ¨¡æ‹Ÿä¸åŒæ—¶é—´ï¼‰
  - å¯¹æ¯”åº¦è°ƒæ•´ï¼ˆæ¨¡æ‹Ÿé›¾éœ¾ï¼‰

#### 1.2 æ¨¡å‹æ¶æ„

```python
# è¯­ä¹‰åˆ†å‰²æ¨¡å‹æ¶æ„ï¼ˆDeepLabV3+ + è‡ªå®šä¹‰æ¨¡å—ï¼‰
class AdvancedRoadSegmentation(nn.Module):
    """
    é«˜çº§é“è·¯åˆ†å‰²æ¨¡å‹
    æ”¯æŒç‹­çª„é“è·¯ã€æ³¥æ³é“è·¯ã€æç«¯å¤©æ°”åœºæ™¯
    """
    def __init__(self, num_classes=2, backbone='resnet50'):
        super().__init__()
        # Backbone
        self.backbone = build_backbone(backbone)
        
        # å¤šå°ºåº¦ç‰¹å¾æå–ï¼ˆASPPï¼‰
        self.aspp = ASPP(2048, 256)
        
        # æ³¨æ„åŠ›æœºåˆ¶ï¼ˆCBAMï¼‰
        self.attention = CBAM(256)
        
        # è¾¹ç•Œç»†åŒ–æ¨¡å—
        self.boundary_refine = BoundaryRefinementModule(256)
        
        # è§£ç å™¨
        self.decoder = Decoder(256, num_classes)
        
        # å¤©æ°”åˆ†ç±»åˆ†æ”¯ï¼ˆå¤šä»»åŠ¡å­¦ä¹ ï¼‰
        self.weather_classifier = WeatherClassifier(256)
    
    def forward(self, x):
        # ç‰¹å¾æå–
        features = self.backbone(x)
        
        # å¤šå°ºåº¦ç‰¹å¾
        aspp_features = self.aspp(features[-1])
        
        # æ³¨æ„åŠ›å¢å¼º
        attended_features = self.attention(aspp_features)
        
        # è¾¹ç•Œç»†åŒ–
        refined_features = self.boundary_refine(attended_features)
        
        # åˆ†å‰²é¢„æµ‹
        seg_output = self.decoder(refined_features, features)
        
        # å¤©æ°”åˆ†ç±»ï¼ˆè¾…åŠ©ä»»åŠ¡ï¼‰
        weather_pred = self.weather_classifier(aspp_features)
        
        return seg_output, weather_pred
```

#### 1.3 æŸå¤±å‡½æ•°è®¾è®¡

```python
# ç»„åˆæŸå¤±å‡½æ•°
class RoadSegmentationLoss(nn.Module):
    """
    é“è·¯åˆ†å‰²æŸå¤±å‡½æ•°
    ç»“åˆå¤šç§æŸå¤±ä»¥æé«˜å›°éš¾æ ·æœ¬çš„è¯†åˆ«èƒ½åŠ›
    """
    def __init__(self):
        super().__init__()
        # äº¤å‰ç†µæŸå¤±ï¼ˆä¸»æŸå¤±ï¼‰
        self.ce_loss = nn.CrossEntropyLoss(weight=torch.tensor([1.0, 2.0]))  # é“è·¯ç±»åˆ«æƒé‡æ›´é«˜
        
        # DiceæŸå¤±ï¼ˆå¤„ç†ç±»åˆ«ä¸å¹³è¡¡ï¼‰
        self.dice_loss = DiceLoss()
        
        # FocalæŸå¤±ï¼ˆå¤„ç†å›°éš¾æ ·æœ¬ï¼‰
        self.focal_loss = FocalLoss(alpha=0.25, gamma=2.0)
        
        # è¾¹ç•ŒæŸå¤±ï¼ˆå¢å¼ºè¾¹ç•Œç²¾åº¦ï¼‰
        self.boundary_loss = BoundaryLoss()
        
        # æƒé‡
        self.weights = [0.4, 0.3, 0.2, 0.1]
    
    def forward(self, pred, target):
        # è®¡ç®—å„é¡¹æŸå¤±
        ce = self.ce_loss(pred, target)
        dice = self.dice_loss(pred, target)
        focal = self.focal_loss(pred, target)
        boundary = self.boundary_loss(pred, target)
        
        # åŠ æƒç»„åˆ
        total_loss = (
            self.weights[0] * ce +
            self.weights[1] * dice +
            self.weights[2] * focal +
            self.weights[3] * boundary
        )
        
        return total_loss, {
            'ce_loss': ce.item(),
            'dice_loss': dice.item(),
            'focal_loss': focal.item(),
            'boundary_loss': boundary.item()
        }
```

### 2. è¯­ä¹‰åˆ†å‰²ç®—æ³• - å†œç”°è¯†åˆ«

#### 2.1 æŒ‘æˆ˜åœºæ™¯è®¾è®¡

##### æ³¥æ³å†œç”°è¯†åˆ«
- **ç‰¹å¾**ï¼šé¢œè‰²ä¸é“è·¯ç›¸ä¼¼ã€è¾¹ç•Œä¸è§„åˆ™ã€çº¹ç†å¤æ‚
- **ç®—æ³•ç­–ç•¥**ï¼š
  - **æ—¶åºä¿¡æ¯**ï¼šåˆ©ç”¨å¤šæ—¶ç›¸æ•°æ®ï¼ˆä¸åŒå­£èŠ‚ï¼‰
  - **å¤šå…‰è°±èåˆ**ï¼šRGB + NIR + Red Edge
  - **å½¢çŠ¶å…ˆéªŒ**ï¼šå†œç”°é€šå¸¸å…·æœ‰è§„åˆ™å½¢çŠ¶ï¼ˆçŸ©å½¢ã€å¤šè¾¹å½¢ï¼‰
- **åå¤„ç†**ï¼š
  - å½¢æ€å­¦æ“ä½œï¼ˆå¼€è¿ç®—ã€é—­è¿ç®—ï¼‰
  - è½®å»“æ£€æµ‹ä¸ç­›é€‰
  - å½¢çŠ¶æ‹Ÿåˆï¼ˆæœ€å°å¤–æ¥çŸ©å½¢ï¼‰

##### ä¸åŒä½œç‰©ç±»å‹è¯†åˆ«
- **ä»»åŠ¡**ï¼šåŒºåˆ†æ°´ç¨»ã€å°éº¦ã€ç‰ç±³ã€å¤§è±†ç­‰
- **ç®—æ³•ç­–ç•¥**ï¼š
  - **å¤šä»»åŠ¡å­¦ä¹ **ï¼šåŒæ—¶è¿›è¡Œåˆ†å‰²å’Œåˆ†ç±»
  - **æ—¶åºç‰¹å¾**ï¼šåˆ©ç”¨ç”Ÿé•¿å‘¨æœŸç‰¹å¾
  - **å¤šå…‰è°±ç‰¹å¾**ï¼šNDVIã€EVIã€NDWIç­‰æŒ‡æ•°
- **æ•°æ®å¢å¼º**ï¼š
  - å­£èŠ‚æ¨¡æ‹Ÿï¼ˆä¸åŒç”Ÿé•¿é˜¶æ®µï¼‰
  - ä½œç‰©ç±»å‹æ··åˆï¼ˆMixUpï¼‰

#### 2.2 æ¨¡å‹æ¶æ„

```python
# å†œç”°åˆ†å‰²æ¨¡å‹ï¼ˆU-Net++ + å¤šå…‰è°±è¾“å…¥ï¼‰
class FarmlandSegmentation(nn.Module):
    """
    å†œç”°åˆ†å‰²æ¨¡å‹
    æ”¯æŒæ³¥æ³å†œç”°ã€ä¸åŒä½œç‰©ç±»å‹è¯†åˆ«
    """
    def __init__(self, num_classes=5, input_channels=4):  # RGB + NIR
        super().__init__()
        # U-Net++ ç¼–ç å™¨
        self.encoder = UNetPlusPlusEncoder(input_channels)
        
        # å¤šå…‰è°±ç‰¹å¾æå–
        self.spectral_branch = SpectralFeatureExtractor(input_channels)
        
        # ç‰¹å¾èåˆ
        self.fusion = FeatureFusionModule(256, 128)
        
        # è§£ç å™¨
        self.decoder = UNetPlusPlusDecoder(256, num_classes)
        
        # ä½œç‰©åˆ†ç±»åˆ†æ”¯
        self.crop_classifier = CropTypeClassifier(256, num_crop_types=10)
    
    def forward(self, x):
        # x: [B, 4, H, W] (RGB + NIR)
        
        # ç¼–ç 
        encoder_features = self.encoder(x)
        
        # å¤šå…‰è°±ç‰¹å¾
        spectral_features = self.spectral_branch(x)
        
        # ç‰¹å¾èåˆ
        fused_features = self.fusion(encoder_features[-1], spectral_features)
        
        # è§£ç 
        seg_output = self.decoder(fused_features, encoder_features)
        
        # ä½œç‰©åˆ†ç±»
        crop_pred = self.crop_classifier(fused_features)
        
        return seg_output, crop_pred
```

### 3. ç›®æ ‡è·Ÿè¸ªç®—æ³•

#### 3.1 DeepSORTå®ç°

```python
# DeepSORTç›®æ ‡è·Ÿè¸ª
class DeepSORTTracker:
    """
    DeepSORTå¤šç›®æ ‡è·Ÿè¸ªå™¨
    ç»“åˆæ£€æµ‹ã€ç‰¹å¾æå–ã€å¡å°”æ›¼æ»¤æ³¢ã€æ•°æ®å…³è”
    """
    def __init__(self, max_age=30, min_hits=3, iou_threshold=0.3):
        self.max_age = max_age
        self.min_hits = min_hits
        self.iou_threshold = iou_threshold
        
        # ç‰¹å¾æå–å™¨ï¼ˆReIDæ¨¡å‹ï¼‰
        self.feature_extractor = ReIDModel()
        
        # å¡å°”æ›¼æ»¤æ³¢å™¨
        self.kalman_filter = KalmanFilter()
        
        # è½¨è¿¹ç®¡ç†
        self.tracks = []
        self.track_id_count = 0
    
    def update(self, detections):
        """
        æ›´æ–°è·Ÿè¸ªå™¨
        
        Args:
            detections: List[Detection] - å½“å‰å¸§çš„æ£€æµ‹ç»“æœ
        
        Returns:
            List[Track] - è·Ÿè¸ªç»“æœ
        """
        # 1. é¢„æµ‹æ‰€æœ‰è½¨è¿¹çš„ä¸‹ä¸€å¸§ä½ç½®
        for track in self.tracks:
            track.predict(self.kalman_filter)
        
        # 2. æ•°æ®å…³è”ï¼ˆåŒ¹é…æ£€æµ‹å’Œè½¨è¿¹ï¼‰
        matches, unmatched_dets, unmatched_trks = self.associate_detections_to_trackers(
            detections, self.tracks
        )
        
        # 3. æ›´æ–°åŒ¹é…çš„è½¨è¿¹
        for m in matches:
            self.tracks[m[1]].update(detections[m[0]], self.feature_extractor)
        
        # 4. åˆ›å»ºæ–°è½¨è¿¹ï¼ˆæœªåŒ¹é…çš„æ£€æµ‹ï¼‰
        for i in unmatched_dets:
            trk = Track(detections[i], self.track_id_count, self.feature_extractor)
            self.tracks.append(trk)
            self.track_id_count += 1
        
        # 5. åˆ é™¤å¤±æ•ˆè½¨è¿¹
        self.tracks = [trk for trk in self.tracks if not trk.is_deleted()]
        
        # 6. è¿”å›ç¡®è®¤çš„è½¨è¿¹
        confirmed_tracks = [trk for trk in self.tracks if trk.hits >= self.min_hits]
        
        return confirmed_tracks
    
    def associate_detections_to_trackers(self, detections, trackers):
        """
        æ•°æ®å…³è”ï¼šåŒˆç‰™åˆ©ç®—æ³• + IoU + ç‰¹å¾ç›¸ä¼¼åº¦
        """
        if len(trackers) == 0:
            return [], list(range(len(detections))), []
        
        # è®¡ç®—IoUçŸ©é˜µ
        iou_matrix = self.compute_iou_matrix(detections, trackers)
        
        # è®¡ç®—ç‰¹å¾ç›¸ä¼¼åº¦çŸ©é˜µ
        feature_matrix = self.compute_feature_similarity(detections, trackers)
        
        # ç»„åˆç›¸ä¼¼åº¦ï¼ˆIoU + ç‰¹å¾ï¼‰
        cost_matrix = 1 - (0.7 * iou_matrix + 0.3 * feature_matrix)
        
        # åŒˆç‰™åˆ©ç®—æ³•åŒ¹é…
        matches, unmatched_dets, unmatched_trks = self.hungarian_matching(cost_matrix)
        
        # è¿‡æ»¤ä½è´¨é‡åŒ¹é…
        matches = [m for m in matches if cost_matrix[m[0], m[1]] < self.iou_threshold]
        
        return matches, unmatched_dets, unmatched_trks
```

#### 3.2 è½¨è¿¹é¢„æµ‹ä¸é®æŒ¡å¤„ç†

```python
# LSTMè½¨è¿¹é¢„æµ‹
class TrajectoryPredictor(nn.Module):
    """
    åŸºäºLSTMçš„è½¨è¿¹é¢„æµ‹
    ç”¨äºå¤„ç†é®æŒ¡å’Œé¢„æµ‹æœªæ¥ä½ç½®
    """
    def __init__(self, input_size=4, hidden_size=128, num_layers=2):
        super().__init__()
        self.lstm = nn.LSTM(input_size, hidden_size, num_layers, batch_first=True)
        self.fc = nn.Linear(hidden_size, input_size)  # é¢„æµ‹ (x, y, w, h)
    
    def forward(self, trajectory, predict_steps=5):
        """
        Args:
            trajectory: [T, 4] - å†å²è½¨è¿¹ (x, y, w, h)
            predict_steps: é¢„æµ‹æ­¥æ•°
        
        Returns:
            predicted: [predict_steps, 4] - é¢„æµ‹è½¨è¿¹
        """
        # LSTMç¼–ç 
        lstm_out, _ = self.lstm(trajectory.unsqueeze(0))
        
        # é¢„æµ‹æœªæ¥ä½ç½®
        predicted = []
        last_hidden = lstm_out[0, -1]
        
        for _ in range(predict_steps):
            next_pos = self.fc(last_hidden)
            predicted.append(next_pos)
            # æ›´æ–°è¾“å…¥ï¼ˆä½¿ç”¨é¢„æµ‹å€¼ï¼‰
            _, (h, c) = self.lstm(next_pos.unsqueeze(0).unsqueeze(0), (last_hidden.unsqueeze(0), c))
            last_hidden = h[0]
        
        return torch.stack(predicted)
```

### 4. å¤šä¼ æ„Ÿå™¨æ•°æ®èåˆ

#### 4.1 å¤šå…‰è°±æ•°æ®å¤„ç†

```python
# å¤šå…‰è°±æ•°æ®å¤„ç†
class MultispectralProcessor:
    """
    å¤šå…‰è°±æ•°æ®å¤„ç†
    è®¡ç®—NDVIã€EVIã€NDWIç­‰æŒ‡æ•°
    """
    def __init__(self):
        self.band_names = ['Blue', 'Green', 'Red', 'NIR', 'RedEdge']
    
    def calculate_ndvi(self, red_band, nir_band):
        """
        è®¡ç®—NDVIï¼ˆå½’ä¸€åŒ–æ¤è¢«æŒ‡æ•°ï¼‰
        NDVI = (NIR - Red) / (NIR + Red)
        """
        ndvi = (nir_band.astype(np.float32) - red_band.astype(np.float32)) / \
               (nir_band.astype(np.float32) + red_band.astype(np.float32) + 1e-8)
        return np.clip(ndvi, -1, 1)
    
    def calculate_evi(self, red_band, nir_band, blue_band):
        """
        è®¡ç®—EVIï¼ˆå¢å¼ºæ¤è¢«æŒ‡æ•°ï¼‰
        EVI = 2.5 * (NIR - Red) / (NIR + 6*Red - 7.5*Blue + 1)
        """
        evi = 2.5 * (nir_band.astype(np.float32) - red_band.astype(np.float32)) / \
             (nir_band.astype(np.float32) + 6*red_band.astype(np.float32) - 
              7.5*blue_band.astype(np.float32) + 1 + 1e-8)
        return np.clip(evi, -1, 1)
    
    def calculate_ndwi(self, green_band, nir_band):
        """
        è®¡ç®—NDWIï¼ˆå½’ä¸€åŒ–æ°´ä½“æŒ‡æ•°ï¼‰
        NDWI = (Green - NIR) / (Green + NIR)
        """
        ndwi = (green_band.astype(np.float32) - nir_band.astype(np.float32)) / \
               (green_band.astype(np.float32) + nir_band.astype(np.float32) + 1e-8)
        return np.clip(ndwi, -1, 1)
    
    def process_multispectral_image(self, multispectral_data):
        """
        å¤„ç†å¤šå…‰è°±å›¾åƒ
        è¿”å›RGBå›¾åƒ + å„ç§æŒ‡æ•°
        """
        # æå–æ³¢æ®µ
        blue = multispectral_data[:, :, 0]
        green = multispectral_data[:, :, 1]
        red = multispectral_data[:, :, 2]
        nir = multispectral_data[:, :, 3]
        red_edge = multispectral_data[:, :, 4] if multispectral_data.shape[2] > 4 else None
        
        # è®¡ç®—æŒ‡æ•°
        ndvi = self.calculate_ndvi(red, nir)
        evi = self.calculate_evi(red, nir, blue)
        ndwi = self.calculate_ndwi(green, nir)
        
        # RGBåˆæˆ
        rgb = np.stack([red, green, blue], axis=2)
        
        return {
            'rgb': rgb,
            'ndvi': ndvi,
            'evi': evi,
            'ndwi': ndwi,
            'nir': nir
        }
```

#### 4.2 çº¢å¤–ä¼ æ„Ÿå™¨å¤„ç†

```python
# çº¢å¤–ä¼ æ„Ÿå™¨å¤„ç†
class ThermalImageProcessor:
    """
    çƒ­æˆåƒå¤„ç†
    æ¸©åº¦å¼‚å¸¸æ£€æµ‹ã€ç›®æ ‡è¯†åˆ«
    """
    def __init__(self, temp_range=(-20, 50)):
        self.temp_range = temp_range
    
    def normalize_temperature(self, thermal_image):
        """
        æ¸©åº¦å½’ä¸€åŒ–
        """
        min_temp, max_temp = self.temp_range
        normalized = (thermal_image - min_temp) / (max_temp - min_temp)
        return np.clip(normalized, 0, 1)
    
    def detect_temperature_anomalies(self, thermal_image, threshold=35):
        """
        æ£€æµ‹æ¸©åº¦å¼‚å¸¸ï¼ˆå¦‚ç«ç¾ã€è®¾å¤‡è¿‡çƒ­ï¼‰
        """
        anomalies = thermal_image > threshold
        return anomalies
    
    def fuse_rgb_thermal(self, rgb_image, thermal_image):
        """
        RGB + çƒ­æˆåƒèåˆ
        ä½¿ç”¨ä¼ªå½©è‰²æ˜ å°„
        """
        # å½’ä¸€åŒ–çƒ­æˆåƒ
        normalized_thermal = self.normalize_temperature(thermal_image)
        
        # ä¼ªå½©è‰²æ˜ å°„ï¼ˆçƒ­æˆåƒ -> RGBï¼‰
        thermal_rgb = self.apply_colormap(normalized_thermal, colormap='hot')
        
        # èåˆï¼ˆåŠ æƒå¹³å‡ï¼‰
        fused = 0.7 * rgb_image + 0.3 * thermal_rgb
        
        return fused.astype(np.uint8)
    
    def apply_colormap(self, image, colormap='hot'):
        """
        åº”ç”¨ä¼ªå½©è‰²æ˜ å°„
        """
        if colormap == 'hot':
            # çƒ­å›¾é¢œè‰²æ˜ å°„
            cmap = plt.get_cmap('hot')
            colored = cmap(image)[:, :, :3]
            return (colored * 255).astype(np.uint8)
        # å…¶ä»–é¢œè‰²æ˜ å°„...
```

#### 4.3 å¤šæ¨¡æ€æ•°æ®èåˆ

```python
# å¤šæ¨¡æ€æ•°æ®èåˆ
class MultimodalFusion(nn.Module):
    """
    å¤šæ¨¡æ€æ•°æ®èåˆ
    RGB + å¤šå…‰è°± + çº¢å¤–
    """
    def __init__(self, rgb_channels=3, spectral_channels=5, thermal_channels=1):
        super().__init__()
        # RGBç‰¹å¾æå–
        self.rgb_encoder = nn.Sequential(
            nn.Conv2d(rgb_channels, 64, 3, padding=1),
            nn.ReLU(),
            nn.Conv2d(64, 128, 3, padding=1),
            nn.ReLU()
        )
        
        # å¤šå…‰è°±ç‰¹å¾æå–
        self.spectral_encoder = nn.Sequential(
            nn.Conv2d(spectral_channels, 64, 3, padding=1),
            nn.ReLU(),
            nn.Conv2d(64, 128, 3, padding=1),
            nn.ReLU()
        )
        
        # çƒ­æˆåƒç‰¹å¾æå–
        self.thermal_encoder = nn.Sequential(
            nn.Conv2d(thermal_channels, 32, 3, padding=1),
            nn.ReLU(),
            nn.Conv2d(32, 64, 3, padding=1),
            nn.ReLU()
        )
        
        # ç‰¹å¾èåˆï¼ˆæ³¨æ„åŠ›æœºåˆ¶ï¼‰
        self.fusion = AttentionFusion(128 + 128 + 64, 256)
    
    def forward(self, rgb, spectral, thermal):
        # ç‰¹å¾æå–
        rgb_feat = self.rgb_encoder(rgb)
        spectral_feat = self.spectral_encoder(spectral)
        thermal_feat = self.thermal_encoder(thermal)
        
        # ç‰¹å¾èåˆ
        fused_feat = self.fusion(rgb_feat, spectral_feat, thermal_feat)
        
        return fused_feat
```

---

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
drone_vision_system/
â”œâ”€â”€ frontend/                          # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ streamlit_app/                # Streamlitåº”ç”¨
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ segmentation.py       # è¯­ä¹‰åˆ†å‰²é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ tracking.py           # ç›®æ ‡è·Ÿè¸ªé¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ fusion.py             # ä¼ æ„Ÿå™¨èåˆé¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ benchmark.py          # æ€§èƒ½æµ‹è¯•é¡µé¢
â”‚   â”‚   â”œâ”€â”€ components/               # ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ visualization.py      # å¯è§†åŒ–ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ file_upload.py        # æ–‡ä»¶ä¸Šä¼ 
â”‚   â”‚   â”‚   â””â”€â”€ result_display.py     # ç»“æœå±•ç¤º
â”‚   â”‚   â””â”€â”€ app.py                    # ä¸»åº”ç”¨
â”‚   â”œâ”€â”€ web_app/                      # React Webåº”ç”¨
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â””â”€â”€ store/
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â””â”€â”€ mobile_app/                   # ç§»åŠ¨ç«¯åº”ç”¨
â”‚       â””â”€â”€ src/
â”œâ”€â”€ backend/                          # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ api/                          # APIæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ main.py                   # FastAPIä¸»åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ routers/                  # è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ segmentation.py
â”‚   â”‚   â”‚   â”œâ”€â”€ tracking.py
â”‚   â”‚   â”‚   â”œâ”€â”€ fusion.py
â”‚   â”‚   â”‚   â””â”€â”€ benchmark.py
â”‚   â”‚   â”œâ”€â”€ models/                   # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ services/                 # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ algorithms/                   # ç®—æ³•æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ segmentation/             # è¯­ä¹‰åˆ†å‰²
â”‚   â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ deeplabv3_plus.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ unet_plus_plus.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ segformer.py
â”‚   â”‚   â”‚   â”œâ”€â”€ losses/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dice_loss.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ focal_loss.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ boundary_loss.py
â”‚   â”‚   â”‚   â”œâ”€â”€ trainers/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ segmentation_trainer.py
â”‚   â”‚   â”‚   â””â”€â”€ inference.py
â”‚   â”‚   â”œâ”€â”€ tracking/                 # ç›®æ ‡è·Ÿè¸ª
â”‚   â”‚   â”‚   â”œâ”€â”€ deepsort.py
â”‚   â”‚   â”‚   â”œâ”€â”€ bytetrack.py
â”‚   â”‚   â”‚   â”œâ”€â”€ kalman_filter.py
â”‚   â”‚   â”‚   â””â”€â”€ trajectory_predictor.py
â”‚   â”‚   â””â”€â”€ fusion/                   # ä¼ æ„Ÿå™¨èåˆ
â”‚   â”‚       â”œâ”€â”€ multispectral.py
â”‚   â”‚       â”œâ”€â”€ thermal.py
â”‚   â”‚       â””â”€â”€ multimodal_fusion.py
â”‚   â””â”€â”€ database/                     # æ•°æ®åº“
â”‚       â”œâ”€â”€ models.py
â”‚       â””â”€â”€ migrations/
â”œâ”€â”€ data/                             # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ raw/                          # åŸå§‹æ•°æ®
â”‚   â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”œâ”€â”€ videos/
â”‚   â”‚   â””â”€â”€ sensors/
â”‚   â”œâ”€â”€ processed/                    # å¤„ç†åçš„æ•°æ®
â”‚   â””â”€â”€ datasets/                     # æ•°æ®é›†
â”‚       â”œâ”€â”€ road_segmentation/
â”‚       â”œâ”€â”€ farmland_segmentation/
â”‚       â””â”€â”€ tracking/
â”œâ”€â”€ models/                           # è®­ç»ƒå¥½çš„æ¨¡å‹
â”‚   â”œâ”€â”€ segmentation/
â”‚   â”œâ”€â”€ tracking/
â”‚   â””â”€â”€ fusion/
â”œâ”€â”€ scripts/                          # è„šæœ¬
â”‚   â”œâ”€â”€ train_segmentation.py
â”‚   â”œâ”€â”€ train_tracking.py
â”‚   â”œâ”€â”€ evaluate_benchmark.py
â”‚   â””â”€â”€ deploy.py
â”œâ”€â”€ tests/                            # æµ‹è¯•
â”‚   â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ integration/
â”‚   â””â”€â”€ benchmark/
â”œâ”€â”€ docker/                           # Dockeré…ç½®
â”‚   â”œâ”€â”€ Dockerfile.api
â”‚   â”œâ”€â”€ Dockerfile.algorithm
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ k8s/                              # Kubernetesé…ç½®
â”‚   â”œâ”€â”€ api-deployment.yaml
â”‚   â”œâ”€â”€ algorithm-service.yaml
â”‚   â””â”€â”€ ingress.yaml
â”œâ”€â”€ requirements.txt                  # Pythonä¾èµ–
â”œâ”€â”€ requirements-frontend.txt         # å‰ç«¯ä¾èµ–
â”œâ”€â”€ README.md
â””â”€â”€ docs/                             # æ–‡æ¡£
    â”œâ”€â”€ api/
    â”œâ”€â”€ algorithms/
    â””â”€â”€ deployment/
```

---

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### 1. å¼€å‘ç¯å¢ƒéƒ¨ç½²

#### 1.1 ç¯å¢ƒå‡†å¤‡

```powershell
# 1. åˆ›å»ºCondaç¯å¢ƒ
conda create -n drone_vision python=3.10 -y
conda activate drone_vision

# 2. å®‰è£…PyTorchï¼ˆGPUç‰ˆæœ¬ï¼‰
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118

# 3. å®‰è£…å…¶ä»–ä¾èµ–
pip install -r requirements.txt

# 4. å®‰è£…å‰ç«¯ä¾èµ–ï¼ˆå¦‚æœéœ€è¦Reactï¼‰
cd frontend/web_app
npm install
```

#### 1.2 å¯åŠ¨æœåŠ¡

```powershell
# å¯åŠ¨FastAPIåç«¯
cd backend/api
uvicorn main:app --reload --port 8000

# å¯åŠ¨Streamlitå‰ç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
cd frontend/streamlit_app
streamlit run app.py --server.port 8501

# å¯åŠ¨Reactå‰ç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
cd frontend/web_app
npm start
```

### 2. Dockeréƒ¨ç½²

#### 2.1 Dockerfileç¤ºä¾‹

```dockerfile
# backend/api/Dockerfile
FROM python:3.10-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    libgl1-mesa-glx \
    libglib2.0-0 \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 8000

# å¯åŠ¨å‘½ä»¤
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
```

#### 2.2 Docker Composeé…ç½®

```yaml
# docker-compose.yml
version: '3.8'

services:
  # PostgreSQLæ•°æ®åº“
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: drone_vision
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  # Redisç¼“å­˜
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

  # MinIOå¯¹è±¡å­˜å‚¨
  minio:
    image: minio/minio:latest
    environment:
      MINIO_ROOT_USER: admin
      MINIO_ROOT_PASSWORD: password
    command: server /data --console-address ":9001"
    ports:
      - "9000:9000"
      - "9001:9001"
    volumes:
      - minio_data:/data

  # FastAPIåç«¯
  api:
    build: ./backend/api
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/drone_vision
      - REDIS_URL=redis://redis:6379
      - MINIO_URL=http://minio:9000
    depends_on:
      - postgres
      - redis
      - minio

  # ç®—æ³•æœåŠ¡ï¼ˆGPUï¼‰
  algorithm-service:
    build: ./backend/algorithms
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    environment:
      - CUDA_VISIBLE_DEVICES=0
    volumes:
      - ./models:/app/models
      - ./data:/app/data

  # Streamlitå‰ç«¯
  streamlit:
    build: ./frontend/streamlit_app
    ports:
      - "8501:8501"
    depends_on:
      - api

volumes:
  postgres_data:
  minio_data:
```

### 3. Kuberneteséƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

#### 3.1 éƒ¨ç½²é…ç½®

```yaml
# k8s/api-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: api-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: api
  template:
    metadata:
      labels:
        app: api
    spec:
      containers:
      - name: api
        image: drone-vision-api:latest
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: db-secret
              key: url
        resources:
          requests:
            memory: "512Mi"
            cpu: "500m"
          limits:
            memory: "2Gi"
            cpu: "2000m"
---
apiVersion: v1
kind: Service
metadata:
  name: api-service
spec:
  selector:
    app: api
  ports:
  - port: 80
    targetPort: 8000
  type: LoadBalancer
```

---

## ğŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•å¥—ä»¶

### 1. è¯„ä¼°æŒ‡æ ‡

```python
# æ€§èƒ½è¯„ä¼°æŒ‡æ ‡
class BenchmarkMetrics:
    """
    æ€§èƒ½åŸºå‡†æµ‹è¯•æŒ‡æ ‡
    """
    def __init__(self):
        self.metrics = {}
    
    def calculate_segmentation_metrics(self, pred, target):
        """
        è¯­ä¹‰åˆ†å‰²æŒ‡æ ‡
        """
        # mIoU (Mean Intersection over Union)
        iou = self.calculate_iou(pred, target)
        miou = np.mean(iou)
        
        # Pixel Accuracy
        pixel_acc = (pred == target).sum() / target.size
        
        # Dice Coefficient
        dice = self.calculate_dice(pred, target)
        
        # F1 Score
        f1 = self.calculate_f1(pred, target)
        
        return {
            'mIoU': miou,
            'pixel_accuracy': pixel_acc,
            'dice_coefficient': dice,
            'f1_score': f1
        }
    
    def calculate_tracking_metrics(self, tracks, ground_truth):
        """
        ç›®æ ‡è·Ÿè¸ªæŒ‡æ ‡
        """
        # MOTA (Multiple Object Tracking Accuracy)
        mota = self.calculate_mota(tracks, ground_truth)
        
        # MOTP (Multiple Object Tracking Precision)
        motp = self.calculate_motp(tracks, ground_truth)
        
        # ID Switches
        id_switches = self.count_id_switches(tracks)
        
        # Track Fragmentation
        frag = self.calculate_fragmentation(tracks)
        
        return {
            'MOTA': mota,
            'MOTP': motp,
            'ID_switches': id_switches,
            'fragmentation': frag
        }
    
    def measure_inference_speed(self, model, input_data, num_runs=100):
        """
        æµ‹é‡æ¨ç†é€Ÿåº¦
        """
        import time
        
        # é¢„çƒ­
        for _ in range(10):
            _ = model(input_data)
        
        # æµ‹é‡
        times = []
        for _ in range(num_runs):
            start = time.time()
            _ = model(input_data)
            times.append(time.time() - start)
        
        avg_time = np.mean(times)
        fps = 1.0 / avg_time
        
        return {
            'avg_inference_time': avg_time,
            'fps': fps,
            'min_time': np.min(times),
            'max_time': np.max(times)
        }
```

### 2. æµ‹è¯•æ•°æ®é›†

```python
# æµ‹è¯•æ•°æ®é›†é…ç½®
TEST_DATASETS = {
    'road_segmentation': {
        'name': 'Road Segmentation Test Set',
        'path': 'data/datasets/road_segmentation/test',
        'scenarios': [
            'narrow_roads',
            'muddy_roads',
            'extreme_weather',
            'night_scenes',
            'foggy_scenes'
        ],
        'metrics': ['mIoU', 'pixel_accuracy', 'fps']
    },
    'farmland_segmentation': {
        'name': 'Farmland Segmentation Test Set',
        'path': 'data/datasets/farmland_segmentation/test',
        'scenarios': [
            'muddy_farmland',
            'different_crops',
            'irregular_boundaries'
        ],
        'metrics': ['mIoU', 'dice_coefficient', 'fps']
    },
    'tracking': {
        'name': 'Multi-Object Tracking Test Set',
        'path': 'data/datasets/tracking/test',
        'scenarios': [
            'occlusion',
            'fast_motion',
            'similar_appearance'
        ],
        'metrics': ['MOTA', 'MOTP', 'ID_switches', 'fps']
    }
}
```

---

## ğŸ“ å®æ–½æ­¥éª¤

### ç¬¬7å‘¨ï¼šåŸºç¡€ç®—æ³•å¼€å‘

#### ç¬¬1-2å¤©ï¼šç¯å¢ƒæ­å»ºä¸æ•°æ®å‡†å¤‡
- [ ] æ­å»ºå¼€å‘ç¯å¢ƒ
- [ ] å‡†å¤‡è®­ç»ƒæ•°æ®é›†
- [ ] æ•°æ®æ ‡æ³¨ä¸éªŒè¯

#### ç¬¬3-4å¤©ï¼šè¯­ä¹‰åˆ†å‰²æ¨¡å‹å¼€å‘
- [ ] å®ç°DeepLabV3+æ¨¡å‹
- [ ] å®ç°æŸå¤±å‡½æ•°
- [ ] æ•°æ®å¢å¼ºç®¡é“

#### ç¬¬5-6å¤©ï¼šé“è·¯è¯†åˆ«ä¼˜åŒ–
- [ ] ç‹­çª„é“è·¯è¯†åˆ«
- [ ] æ³¥æ³é“è·¯è¯†åˆ«
- [ ] æç«¯å¤©æ°”å¤„ç†

#### ç¬¬7å¤©ï¼šå†œç”°è¯†åˆ«å¼€å‘
- [ ] å†œç”°åˆ†å‰²æ¨¡å‹
- [ ] å¤šå…‰è°±æ•°æ®å¤„ç†
- [ ] ä½œç‰©ç±»å‹åˆ†ç±»

### ç¬¬8å‘¨ï¼šé«˜çº§åŠŸèƒ½ä¸é›†æˆ

#### ç¬¬1-2å¤©ï¼šç›®æ ‡è·Ÿè¸ªå®ç°
- [ ] DeepSORTå®ç°
- [ ] è½¨è¿¹é¢„æµ‹
- [ ] é®æŒ¡å¤„ç†

#### ç¬¬3-4å¤©ï¼šä¼ æ„Ÿå™¨èåˆ
- [ ] å¤šå…‰è°±å¤„ç†
- [ ] çº¢å¤–å¤„ç†
- [ ] å¤šæ¨¡æ€èåˆ

#### ç¬¬5-6å¤©ï¼šæ€§èƒ½æµ‹è¯•å¥—ä»¶
- [ ] è¯„ä¼°æŒ‡æ ‡å®ç°
- [ ] æµ‹è¯•æ•°æ®é›†å‡†å¤‡
- [ ] è‡ªåŠ¨åŒ–æµ‹è¯•

#### ç¬¬7å¤©ï¼šç³»ç»Ÿé›†æˆä¸éƒ¨ç½²
- [ ] APIé›†æˆ
- [ ] å‰ç«¯ç•Œé¢
- [ ] éƒ¨ç½²æµ‹è¯•

---

## âœ… æ£€æŸ¥æ¸…å•

### ç®—æ³•å¼€å‘
- [ ] è¯­ä¹‰åˆ†å‰²æ¨¡å‹è®­ç»ƒå®Œæˆ
- [ ] ç›®æ ‡è·Ÿè¸ªç®—æ³•å®ç°
- [ ] ä¼ æ„Ÿå™¨èåˆåŠŸèƒ½å®Œæˆ
- [ ] æ€§èƒ½è¾¾åˆ°é¢„æœŸæŒ‡æ ‡

### ç³»ç»Ÿé›†æˆ
- [ ] APIæœåŠ¡æ­£å¸¸è¿è¡Œ
- [ ] å‰ç«¯ç•Œé¢åŠŸèƒ½å®Œæ•´
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] æ–‡ä»¶å­˜å‚¨é…ç½®æ­£ç¡®

### éƒ¨ç½²æµ‹è¯•
- [ ] å¼€å‘ç¯å¢ƒæµ‹è¯•é€šè¿‡
- [ ] Dockeréƒ¨ç½²æˆåŠŸ
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] æ–‡æ¡£å®Œæ•´

---

**æœ¬æ–¹æ¡ˆæä¾›äº†å®Œæ•´çš„æŠ€æœ¯æ¶æ„ã€ç®—æ³•è®¾è®¡ã€éƒ¨ç½²æ–¹æ¡ˆå’Œå®æ–½æ­¥éª¤ï¼Œç¡®ä¿ç¬¬7-8å‘¨ä»»åŠ¡é«˜è´¨é‡å®Œæˆï¼** ğŸš€

