# ç¬¬6å‘¨å·¥ä½œéƒ¨ç½²æ–‡æ¡£ - æ— äººæœºç´ æ8ç»´åº¦æ™ºèƒ½åˆ†æAgentç³»ç»Ÿ
## å®Œæ•´è¯¦ç»†ç‰ˆ - æ¯ä¸ªæ­¥éª¤éƒ½æœ‰å…·ä½“å‘½ä»¤

> **é‡è¦**: æœ¬æ–‡æ¡£åŒ…å«æ‰€æœ‰å¯æ‰§è¡Œçš„å‘½ä»¤ï¼Œç›´æ¥å¤åˆ¶ç²˜è´´å³å¯ä½¿ç”¨

---

## ğŸ“ ç¬¬ä¸€æ­¥ï¼šå»ºç«‹å®Œæ•´çš„ç›®å½•ç»“æ„

### 1.1 æ‰“å¼€PowerShellå¹¶å®šä½åˆ°é¡¹ç›®ç›®å½•

**æ“ä½œæ­¥éª¤**:
1. æŒ‰ `Win + X`ï¼Œé€‰æ‹©"Windows PowerShell"æˆ–"ç»ˆç«¯"
2. æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›å…¥é¡¹ç›®ç›®å½•ï¼š

```powershell
# è¿›å…¥é¡¹ç›®æ ¹ç›®å½•
cd D:\mlflow_learning_project

# éªŒè¯å½“å‰ä½ç½®ï¼ˆåº”è¯¥æ˜¾ç¤º D:\mlflow_learning_projectï¼‰
pwd
```

**é¢„æœŸè¾“å‡º**:
```
Path
----
D:\mlflow_learning_project
```

### 1.2 åˆ›å»ºæ‰€æœ‰å¿…éœ€çš„ç›®å½•ç»“æ„

**æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºç›®å½•**:

```powershell
# åˆ›å»ºagentsç›®å½•ï¼ˆæ ¸å¿ƒåˆ†ææ¨¡å—ï¼‰
New-Item -ItemType Directory -Path "agents" -Force | Out-Null
Write-Host "âœ… åˆ›å»ºç›®å½•: agents" -ForegroundColor Green

# åˆ›å»ºapp/webç›®å½•ï¼ˆWebç•Œé¢ï¼‰
New-Item -ItemType Directory -Path "app\web" -Force | Out-Null
Write-Host "âœ… åˆ›å»ºç›®å½•: app\web" -ForegroundColor Green

# åˆ›å»ºscriptsç›®å½•ï¼ˆè„šæœ¬æ–‡ä»¶ï¼‰
New-Item -ItemType Directory -Path "scripts" -Force | Out-Null
Write-Host "âœ… åˆ›å»ºç›®å½•: scripts" -ForegroundColor Green

# åˆ›å»ºreportsç›®å½•ï¼ˆåˆ†ææŠ¥å‘Šè¾“å‡ºï¼‰
New-Item -ItemType Directory -Path "reports" -Force | Out-Null
Write-Host "âœ… åˆ›å»ºç›®å½•: reports" -ForegroundColor Green

# åˆ›å»ºtemp_uploadsç›®å½•ï¼ˆä¸´æ—¶ä¸Šä¼ æ–‡ä»¶ï¼‰
New-Item -ItemType Directory -Path "temp_uploads" -Force | Out-Null
Write-Host "âœ… åˆ›å»ºç›®å½•: temp_uploads" -ForegroundColor Green

# åˆ›å»ºtest_imagesç›®å½•ï¼ˆæµ‹è¯•å›¾ç‰‡ï¼‰
New-Item -ItemType Directory -Path "test_images" -Force | Out-Null
Write-Host "âœ… åˆ›å»ºç›®å½•: test_images" -ForegroundColor Green

# åˆ›å»ºtest_images/batchç›®å½•ï¼ˆæ‰¹é‡æµ‹è¯•ï¼‰
New-Item -ItemType Directory -Path "test_images\batch" -Force | Out-Null
Write-Host "âœ… åˆ›å»ºç›®å½•: test_images\batch" -ForegroundColor Green

# åˆ›å»ºtest_resultsç›®å½•ï¼ˆæµ‹è¯•ç»“æœï¼‰
New-Item -ItemType Directory -Path "test_results" -Force | Out-Null
Write-Host "âœ… åˆ›å»ºç›®å½•: test_results" -ForegroundColor Green

# åˆ›å»ºreal_data_testç›®å½•ï¼ˆçœŸå®æ•°æ®æµ‹è¯•ï¼‰
New-Item -ItemType Directory -Path "real_data_test" -Force | Out-Null
Write-Host "âœ… åˆ›å»ºç›®å½•: real_data_test" -ForegroundColor Green

# åˆ›å»ºreal_data_resultsç›®å½•ï¼ˆçœŸå®æ•°æ®ç»“æœï¼‰
New-Item -ItemType Directory -Path "real_data_results" -Force | Out-Null
Write-Host "âœ… åˆ›å»ºç›®å½•: real_data_results" -ForegroundColor Green

# åˆ›å»ºfinal_reportç›®å½•ï¼ˆæœ€ç»ˆæŠ¥å‘Šï¼‰
New-Item -ItemType Directory -Path "final_report" -Force | Out-Null
Write-Host "âœ… åˆ›å»ºç›®å½•: final_report" -ForegroundColor Green
```

**éªŒè¯ç›®å½•ç»“æ„**:

```powershell
# æŸ¥çœ‹æ‰€æœ‰åˆ›å»ºçš„ç›®å½•
Get-ChildItem -Directory | Select-Object Name, FullName | Format-Table -AutoSize
```

**é¢„æœŸè¾“å‡º**:
```
Name              FullName
----              --------
agents            D:\mlflow_learning_project\agents
app               D:\mlflow_learning_project\app
reports           D:\mlflow_learning_project\reports
scripts           D:\mlflow_learning_project\scripts
temp_uploads      D:\mlflow_learning_project\temp_uploads
test_images       D:\mlflow_learning_project\test_images
test_results      D:\mlflow_learning_project\test_results
real_data_test    D:\mlflow_learning_project\real_data_test
real_data_results D:\mlflow_learning_project\real_data_results
final_report      D:\mlflow_learning_project\final_report
```

---

## ğŸ”§ ç¬¬äºŒæ­¥ï¼šç¯å¢ƒé…ç½®ä¸ä¾èµ–å®‰è£…

### 2.1 æ¿€æ´»Condaç¯å¢ƒ

**æ‰§è¡Œå‘½ä»¤**:

```powershell
# æ¿€æ´»uav_advç¯å¢ƒ
conda activate uav_adv

# éªŒè¯ç¯å¢ƒæ¿€æ´»æˆåŠŸï¼ˆå‘½ä»¤æç¤ºç¬¦å‰åº”è¯¥æ˜¾ç¤º (uav_adv)ï¼‰
# å¦‚æœçœ‹åˆ° (uav_adv) PS D:\mlflow_learning_project> è¯´æ˜æˆåŠŸ
```

**éªŒè¯ç¯å¢ƒ**:

```powershell
# æ£€æŸ¥å½“å‰Pythonè·¯å¾„
python --version

# æ£€æŸ¥Condaç¯å¢ƒ
conda env list
```

**é¢„æœŸè¾“å‡º**:
```
Python 3.10.x
# conda environments:
#
base                     C:\Anaconda3
uav_adv               *  C:\Anaconda3\envs\uav_adv
```

### 2.2 æ£€æŸ¥å¹¶å®‰è£…åŸºç¡€ä¾èµ–

**é€æ­¥æ£€æŸ¥æ¯ä¸ªä¾èµ–åŒ…**:

```powershell
# æ£€æŸ¥NumPy
python -c "import numpy; print('NumPyç‰ˆæœ¬:', numpy.__version__)"
# å¦‚æœæŠ¥é”™ï¼Œæ‰§è¡Œ: pip install numpy==1.23.5

# æ£€æŸ¥OpenCV
python -c "import cv2; print('OpenCVç‰ˆæœ¬:', cv2.__version__)"
# å¦‚æœæŠ¥é”™ï¼Œæ‰§è¡Œ: pip install opencv-python-headless==4.9.0.80

# æ£€æŸ¥PyTorch
python -c "import torch; print('PyTorchç‰ˆæœ¬:', torch.__version__); print('CUDAå¯ç”¨:', torch.cuda.is_available())"
# å¦‚æœæŠ¥é”™ï¼Œæ‰§è¡Œ: pip install torch==2.0.1+cu118 torchvision==0.15.2+cu118 --index-url https://download.pytorch.org/whl/cu118
```

### 2.3 å®‰è£…æ–°å¢ä¾èµ–åŒ…

**æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…å¿…éœ€çš„åŒ…**:

```powershell
# å®‰è£…ultralytics (YOLOv8)
pip install ultralytics==8.2.74

# å®‰è£…plotly (å¯è§†åŒ–)
pip install plotly>=5.23.0

# å®‰è£…streamlit (Webç•Œé¢)
pip install streamlit>=1.37.1

# å®‰è£…pandas (æ•°æ®å¤„ç†)
pip install pandas>=2.0.3

# å®‰è£…Pillow (å›¾åƒå¤„ç†)
pip install pillow>=9.5.0
```

**éªŒè¯å®‰è£…**:

```powershell
# éªŒè¯æ‰€æœ‰åŒ…éƒ½èƒ½æ­£å¸¸å¯¼å…¥
python -c "
import ultralytics
import plotly
import streamlit
import pandas
import PIL
print('âœ… æ‰€æœ‰ä¾èµ–åŒ…å®‰è£…æˆåŠŸ')
"
```

**é¢„æœŸè¾“å‡º**:
```
âœ… æ‰€æœ‰ä¾èµ–åŒ…å®‰è£…æˆåŠŸ
```

---

## ğŸ“ ç¬¬ä¸‰æ­¥ï¼šéªŒè¯æ ¸å¿ƒæ–‡ä»¶æ˜¯å¦å­˜åœ¨

### 3.1 æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨

**æ‰§è¡Œå‘½ä»¤æ£€æŸ¥æ‰€æœ‰æ ¸å¿ƒæ–‡ä»¶**:

```powershell
# å®šä¹‰éœ€è¦æ£€æŸ¥çš„æ–‡ä»¶åˆ—è¡¨
$requiredFiles = @(
    "agents\__init__.py",
    "agents\image_quality_analyzer.py",
    "agents\material_generator_agent.py",
    "app\web\material_analyzer_app.py",
    "scripts\batch_analyze.py",
    "scripts\generate_report.py",
    "start_material_analyzer.ps1"
)

# æ£€æŸ¥æ¯ä¸ªæ–‡ä»¶
Write-Host "`næ£€æŸ¥æ ¸å¿ƒæ–‡ä»¶..." -ForegroundColor Cyan
$missingFiles = @()
foreach ($file in $requiredFiles) {
    if (Test-Path $file) {
        $size = (Get-Item $file).Length
        Write-Host "âœ… $file ($([math]::Round($size/1KB, 2)) KB)" -ForegroundColor Green
    } else {
        Write-Host "âŒ ç¼ºå¤±: $file" -ForegroundColor Red
        $missingFiles += $file
    }
}

if ($missingFiles.Count -eq 0) {
    Write-Host "`nâœ… æ‰€æœ‰æ ¸å¿ƒæ–‡ä»¶éƒ½å­˜åœ¨" -ForegroundColor Green
} else {
    Write-Host "`nâŒ ä»¥ä¸‹æ–‡ä»¶ç¼ºå¤±ï¼Œéœ€è¦åˆ›å»º:" -ForegroundColor Red
    $missingFiles | ForEach-Object { Write-Host "  - $_" -ForegroundColor Yellow }
}
```

### 3.2 å¦‚æœæ–‡ä»¶ç¼ºå¤±ï¼Œåˆ›å»ºå®ƒä»¬

**å¦‚æœagentsç›®å½•ä¸‹çš„æ–‡ä»¶ç¼ºå¤±ï¼Œæ‰§è¡Œ**:

```powershell
# æ£€æŸ¥agentsç›®å½•
if (-not (Test-Path "agents\__init__.py")) {
    Write-Host "åˆ›å»º agents\__init__.py..." -ForegroundColor Yellow
    @"
"""
æ— äººæœºç´ æåˆ†æAgentæ¨¡å—
"""
from .image_quality_analyzer import ImageQualityAnalyzer
from .material_generator_agent import MaterialGeneratorAgent

__all__ = ['ImageQualityAnalyzer', 'MaterialGeneratorAgent']
"@ | Out-File -FilePath "agents\__init__.py" -Encoding UTF8
    Write-Host "âœ… å·²åˆ›å»º" -ForegroundColor Green
}
```

**æ³¨æ„**: å¦‚æœæ ¸å¿ƒPythonæ–‡ä»¶ç¼ºå¤±ï¼Œéœ€è¦ä»ä¹‹å‰çš„åˆ›å»ºä¸­è·å–å®Œæ•´ä»£ç ã€‚

---

## ğŸ§ª ç¬¬å››æ­¥ï¼šæµ‹è¯•YOLOæ¨¡å‹

### 4.1 æµ‹è¯•YOLOæ¨¡å‹åŠ è½½

**æ‰§è¡Œå‘½ä»¤**:

```powershell
# æµ‹è¯•YOLOæ¨¡å‹ï¼ˆé¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨ä¸‹è½½ï¼Œéœ€è¦ç½‘ç»œï¼‰
python -c "
from ultralytics import YOLO
import torch
import sys

print('=' * 50)
print('YOLOæ¨¡å‹æµ‹è¯•')
print('=' * 50)

# æ£€æŸ¥è®¾å¤‡
device = 'CUDA' if torch.cuda.is_available() else 'CPU'
print(f'ä½¿ç”¨è®¾å¤‡: {device}')
if torch.cuda.is_available():
    print(f'GPUåç§°: {torch.cuda.get_device_name(0)}')
    print(f'GPUå†…å­˜: {torch.cuda.get_device_properties(0).total_memory / 1024**3:.2f} GB')

# åŠ è½½æ¨¡å‹ï¼ˆé¦–æ¬¡ä¼šä¸‹è½½ï¼‰
print('æ­£åœ¨åŠ è½½YOLOæ¨¡å‹...')
try:
    model = YOLO('yolov8n.pt')
    print('âœ… YOLOæ¨¡å‹åŠ è½½æˆåŠŸ')
    print(f'æ¨¡å‹ç±»åˆ«æ•°: {len(model.names)}')
    print(f'æ¨¡å‹è¾“å…¥å°ºå¯¸: {model.imgsz}')
except Exception as e:
    print(f'âŒ æ¨¡å‹åŠ è½½å¤±è´¥: {e}')
    sys.exit(1)

print('=' * 50)
"
```

**é¢„æœŸè¾“å‡º**:
```
==================================================
YOLOæ¨¡å‹æµ‹è¯•
==================================================
ä½¿ç”¨è®¾å¤‡: CUDA (æˆ– CPU)
GPUåç§°: NVIDIA GeForce RTX 3060 (å¦‚æœæœ‰GPU)
GPUå†…å­˜: 12.00 GB (å¦‚æœæœ‰GPU)
æ­£åœ¨åŠ è½½YOLOæ¨¡å‹...
Downloading https://github.com/ultralytics/assets/releases/download/v0.0.0/yolov8n.pt...
âœ… YOLOæ¨¡å‹åŠ è½½æˆåŠŸ
æ¨¡å‹ç±»åˆ«æ•°: 80
æ¨¡å‹è¾“å…¥å°ºå¯¸: 640
==================================================
```

**å¦‚æœä¸‹è½½å¤±è´¥**:
```powershell
# æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹çš„æ–¹æ³•
# 1. è®¿é—®: https://github.com/ultralytics/assets/releases/download/v0.0.0/yolov8n.pt
# 2. ä¸‹è½½åæ”¾åˆ°: C:\Users\ä½ çš„ç”¨æˆ·å\.ultralytics\weights\yolov8n.pt
```

---

## ğŸ“¸ ç¬¬äº”æ­¥ï¼šå‡†å¤‡æµ‹è¯•å›¾ç‰‡

### 5.1 å‡†å¤‡å•å›¾æµ‹è¯•

**æ–¹æ³•1: å¦‚æœæœ‰ç°æˆçš„æ— äººæœºå›¾ç‰‡**:

```powershell
# æŸ¥æ‰¾ç°æœ‰çš„æ— äººæœºå›¾ç‰‡
$droneImages = Get-ChildItem -Path "D:\" -Recurse -Include "*.jpg","*.jpeg","*.png" -ErrorAction SilentlyContinue | 
    Where-Object { $_.FullName -like "*æ— äººæœº*" -or $_.FullName -like "*drone*" } | 
    Select-Object -First 1

if ($droneImages) {
    Copy-Item $droneImages.FullName -Destination "test_images\test_single.jpg"
    Write-Host "âœ… å·²å¤åˆ¶æµ‹è¯•å›¾ç‰‡: test_images\test_single.jpg" -ForegroundColor Green
} else {
    Write-Host "âš ï¸ æœªæ‰¾åˆ°æ— äººæœºå›¾ç‰‡ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ä¸€å¼ å›¾ç‰‡åˆ° test_images\test_single.jpg" -ForegroundColor Yellow
}
```

**æ–¹æ³•2: æ‰‹åŠ¨å¤åˆ¶å›¾ç‰‡**:

```powershell
# æ‰“å¼€test_imagesç›®å½•ï¼Œæ‰‹åŠ¨å¤åˆ¶ä¸€å¼ å›¾ç‰‡è¿›å»
explorer test_images

# æˆ–è€…ä½¿ç”¨å‘½ä»¤å¤åˆ¶ï¼ˆæ›¿æ¢ä¸ºä½ çš„å®é™…è·¯å¾„ï¼‰
# Copy-Item "D:\ä½ çš„å›¾ç‰‡è·¯å¾„\image.jpg" -Destination "test_images\test_single.jpg"
```

**éªŒè¯å›¾ç‰‡å­˜åœ¨**:

```powershell
# æ£€æŸ¥æµ‹è¯•å›¾ç‰‡
if (Test-Path "test_images\test_single.jpg") {
    $img = Get-Item "test_images\test_single.jpg"
    Write-Host "âœ… æµ‹è¯•å›¾ç‰‡å­˜åœ¨: $($img.Name)" -ForegroundColor Green
    Write-Host "   æ–‡ä»¶å¤§å°: $([math]::Round($img.Length/1MB, 2)) MB" -ForegroundColor Cyan
    Write-Host "   ä¿®æ”¹æ—¶é—´: $($img.LastWriteTime)" -ForegroundColor Cyan
} else {
    Write-Host "âŒ æµ‹è¯•å›¾ç‰‡ä¸å­˜åœ¨ï¼Œè¯·å…ˆå‡†å¤‡ä¸€å¼ å›¾ç‰‡" -ForegroundColor Red
}
```

### 5.2 å‡†å¤‡æ‰¹é‡æµ‹è¯•å›¾ç‰‡

**æ‰§è¡Œå‘½ä»¤**:

```powershell
# åˆ›å»ºæ‰¹é‡æµ‹è¯•ç›®å½•
if (-not (Test-Path "test_images\batch")) {
    New-Item -ItemType Directory -Path "test_images\batch" -Force | Out-Null
}

# å¦‚æœæœ‰å•å¼ æµ‹è¯•å›¾ç‰‡ï¼Œå¤åˆ¶å¤šä»½ç”¨äºæ‰¹é‡æµ‹è¯•
if (Test-Path "test_images\test_single.jpg") {
    1..5 | ForEach-Object {
        Copy-Item "test_images\test_single.jpg" -Destination "test_images\batch\test_batch_$_.jpg" -Force
    }
    Write-Host "âœ… å·²åˆ›å»º5å¼ æ‰¹é‡æµ‹è¯•å›¾ç‰‡" -ForegroundColor Green
}

# æˆ–è€…ä»å…¶ä»–ç›®å½•å¤åˆ¶å¤šå¼ å›¾ç‰‡
# Copy-Item "D:\æ— äººæœºç´ æ\*.jpg" -Destination "test_images\batch\" -ErrorAction SilentlyContinue

# æ£€æŸ¥æ‰¹é‡æµ‹è¯•å›¾ç‰‡æ•°é‡
$batchCount = (Get-ChildItem "test_images\batch\*.jpg" -ErrorAction SilentlyContinue).Count
Write-Host "æ‰¹é‡æµ‹è¯•å›¾ç‰‡æ•°é‡: $batchCount" -ForegroundColor Cyan
```

---

## ğŸš€ ç¬¬å…­æ­¥ï¼šæµ‹è¯•å•å›¾åˆ†æåŠŸèƒ½

### 6.1 æ‰§è¡Œå•å›¾åˆ†ææµ‹è¯•

**æ‰§è¡Œå®Œæ•´æµ‹è¯•å‘½ä»¤**:

```powershell
# è·å–æµ‹è¯•å›¾ç‰‡è·¯å¾„
$testImage = Get-ChildItem "test_images\*.jpg" | Select-Object -First 1

if (-not $testImage) {
    Write-Host "âŒ æœªæ‰¾åˆ°æµ‹è¯•å›¾ç‰‡ï¼Œè¯·å…ˆå‡†å¤‡æµ‹è¯•å›¾ç‰‡" -ForegroundColor Red
    exit
}

Write-Host "`nå¼€å§‹å•å›¾åˆ†ææµ‹è¯•..." -ForegroundColor Cyan
Write-Host "æµ‹è¯•å›¾ç‰‡: $($testImage.Name)" -ForegroundColor Yellow
Write-Host "=" * 60 -ForegroundColor Cyan

# æ‰§è¡Œåˆ†æ
python -c "
import sys
import os
sys.path.insert(0, '.')

from agents.image_quality_analyzer import ImageQualityAnalyzer
from pathlib import Path
import time

print('æ­£åœ¨åˆå§‹åŒ–åˆ†æå™¨...')
start_time = time.time()
analyzer = ImageQualityAnalyzer()
init_time = time.time() - start_time
print(f'åˆå§‹åŒ–è€—æ—¶: {init_time:.2f}ç§’')

print('æ­£åœ¨åˆ†æå›¾ç‰‡...')
test_image = r'$($testImage.FullName)'
start_time = time.time()
result = analyzer.analyze_single_image(test_image)
analysis_time = time.time() - start_time

print(f'\nåˆ†æè€—æ—¶: {analysis_time:.2f}ç§’')
print('=' * 60)
print('8ç»´åº¦åˆ†æç»“æœ:')
print('=' * 60)

for dim, score in result.items():
    level = 'ä¼˜ç§€' if score >= 90 else 'è‰¯å¥½' if score >= 80 else 'ä¸­ç­‰' if score >= 70 else 'ä¸€èˆ¬' if score >= 60 else 'è¾ƒå·®'
    print(f'{dim:20s}: {score:6.2f}% ({level})')

print('=' * 60)
avg_score = sum(result.values()) / len(result)
print(f'å¹³å‡å¾—åˆ†: {avg_score:.2f}%')
print(f'æ€»è€—æ—¶: {init_time + analysis_time:.2f}ç§’')
print('=' * 60)
print('âœ… å•å›¾åˆ†ææµ‹è¯•å®Œæˆ')
"
```

**é¢„æœŸè¾“å‡º**:
```
å¼€å§‹å•å›¾åˆ†ææµ‹è¯•...
æµ‹è¯•å›¾ç‰‡: test_single.jpg
============================================================
æ­£åœ¨åˆå§‹åŒ–åˆ†æå™¨...
åˆå§‹åŒ–è€—æ—¶: 2.35ç§’
æ­£åœ¨åˆ†æå›¾ç‰‡...
åˆ†æè€—æ—¶: 1.82ç§’
============================================================
8ç»´åº¦åˆ†æç»“æœ:
============================================================
å›¾ç‰‡æ•°æ®é‡          :  95.23% (ä¼˜ç§€)
æ‹æ‘„å…‰ç…§è´¨é‡        :  88.45% (è‰¯å¥½)
ç›®æ ‡å°ºå¯¸            :  92.10% (ä¼˜ç§€)
ç›®æ ‡å®Œæ•´æ€§          :  85.30% (è‰¯å¥½)
æ•°æ®å‡è¡¡åº¦          :  78.90% (ä¸­ç­‰)
äº§å“ä¸°å¯Œåº¦          :  90.00% (ä¼˜ç§€)
ç›®æ ‡å¯†é›†åº¦          :  87.60% (è‰¯å¥½)
åœºæ™¯å¤æ‚åº¦          :  82.40% (è‰¯å¥½)
============================================================
å¹³å‡å¾—åˆ†: 87.50%
æ€»è€—æ—¶: 4.17ç§’
============================================================
âœ… å•å›¾åˆ†ææµ‹è¯•å®Œæˆ
```

### 6.2 éªŒè¯åˆ†æç»“æœ

**æ‰§è¡ŒéªŒè¯å‘½ä»¤**:

```powershell
python -c "
import sys
sys.path.insert(0, '.')
from agents.image_quality_analyzer import ImageQualityAnalyzer

analyzer = ImageQualityAnalyzer()
test_image = r'$($testImage.FullName)'
result = analyzer.analyze_single_image(test_image)

# éªŒè¯æ£€æŸ¥
print('=' * 60)
print('ç»“æœéªŒè¯')
print('=' * 60)

# æ£€æŸ¥1: æ‰€æœ‰ç»´åº¦éƒ½å­˜åœ¨
dimensions = ['å›¾ç‰‡æ•°æ®é‡', 'æ‹æ‘„å…‰ç…§è´¨é‡', 'ç›®æ ‡å°ºå¯¸', 'ç›®æ ‡å®Œæ•´æ€§', 
              'æ•°æ®å‡è¡¡åº¦', 'äº§å“ä¸°å¯Œåº¦', 'ç›®æ ‡å¯†é›†åº¦', 'åœºæ™¯å¤æ‚åº¦']
missing = [d for d in dimensions if d not in result]
if missing:
    print(f'âŒ ç¼ºå¤±ç»´åº¦: {missing}')
else:
    print('âœ… æ‰€æœ‰8ä¸ªç»´åº¦éƒ½å­˜åœ¨')

# æ£€æŸ¥2: åˆ†æ•°èŒƒå›´
invalid_scores = [(d, s) for d, s in result.items() if s < 0 or s > 100]
if invalid_scores:
    print(f'âŒ åˆ†æ•°è¶…å‡ºèŒƒå›´: {invalid_scores}')
else:
    print('âœ… æ‰€æœ‰åˆ†æ•°åœ¨0-100èŒƒå›´å†…')

# æ£€æŸ¥3: å¹³å‡åˆ†åˆç†æ€§
avg = sum(result.values()) / len(result)
if 50 <= avg <= 95:
    print(f'âœ… å¹³å‡åˆ†åˆç†: {avg:.2f}%')
else:
    print(f'âš ï¸ å¹³å‡åˆ†å¼‚å¸¸: {avg:.2f}% (é€šå¸¸åº”åœ¨50-95ä¹‹é—´)')

print('=' * 60)
"
```

---

## ğŸ“¦ ç¬¬ä¸ƒæ­¥ï¼šæµ‹è¯•æ‰¹é‡åˆ†æåŠŸèƒ½

### 7.1 æ‰§è¡Œæ‰¹é‡åˆ†æ

**æ‰§è¡Œå‘½ä»¤**:

```powershell
# æ£€æŸ¥æ‰¹é‡æµ‹è¯•å›¾ç‰‡
$batchImages = Get-ChildItem "test_images\batch\*.jpg" -ErrorAction SilentlyContinue
if ($batchImages.Count -eq 0) {
    Write-Host "âŒ æ‰¹é‡æµ‹è¯•å›¾ç‰‡ä¸å­˜åœ¨ï¼Œè¯·å…ˆå‡†å¤‡" -ForegroundColor Red
    exit
}

Write-Host "`nå¼€å§‹æ‰¹é‡åˆ†ææµ‹è¯•..." -ForegroundColor Cyan
Write-Host "å›¾ç‰‡æ•°é‡: $($batchImages.Count)" -ForegroundColor Yellow
Write-Host "=" * 60 -ForegroundColor Cyan

# æ‰§è¡Œæ‰¹é‡åˆ†æ
python scripts\batch_analyze.py `
  --input-dir "test_images\batch" `
  --output-dir "test_results" `
  --min-quality 70

# æ£€æŸ¥ç»“æœ
Write-Host "`næ£€æŸ¥åˆ†æç»“æœ..." -ForegroundColor Cyan
if (Test-Path "test_results") {
    Get-ChildItem "test_results\*" | ForEach-Object {
        Write-Host "  âœ… $($_.Name) ($([math]::Round($_.Length/1KB, 2)) KB)" -ForegroundColor Green
    }
}
```

**é¢„æœŸè¾“å‡º**:
```
å¼€å§‹æ‰¹é‡åˆ†ææµ‹è¯•...
å›¾ç‰‡æ•°é‡: 5
============================================================
ğŸ“¸ æ‰¾åˆ° 5 å¼ å›¾ç‰‡
ğŸš€ å¼€å§‹æ‰¹é‡åˆ†æ...
æ­£åœ¨åˆå§‹åŒ–åˆ†æå™¨...
æ­£åœ¨åˆ†æå›¾ç‰‡ 1/5...
æ­£åœ¨åˆ†æå›¾ç‰‡ 2/5...
æ­£åœ¨åˆ†æå›¾ç‰‡ 3/5...
æ­£åœ¨åˆ†æå›¾ç‰‡ 4/5...
æ­£åœ¨åˆ†æå›¾ç‰‡ 5/5...
âœ… å®Œæ•´ç»“æœå·²ä¿å­˜åˆ°: test_results\analysis_result_20241111_143022.json
âœ… é«˜è´¨é‡ç´ æåˆ—è¡¨å·²ä¿å­˜åˆ°: test_results\high_quality_materials_20241111_143022.txt
âœ… è¯¦ç»†æŠ¥å‘Šå·²ä¿å­˜åˆ°: test_results\material_report_20241111_143022.json

ğŸ“ˆ ç»Ÿè®¡ä¿¡æ¯:
  æ€»å›¾ç‰‡æ•°: 5
  æ€»æ ‡æ³¨æ•°: 125
  æ•´ä½“è´¨é‡: 82.35
  é«˜è´¨é‡å›¾ç‰‡: 4

ğŸ“Š å¹³å‡ç»´åº¦å¾—åˆ†:
  å›¾ç‰‡æ•°æ®é‡: 95.20%
  æ‹æ‘„å…‰ç…§è´¨é‡: 88.50%
  ...

æ£€æŸ¥åˆ†æç»“æœ...
  âœ… analysis_result_20241111_143022.json (45.2 KB)
  âœ… high_quality_materials_20241111_143022.txt (0.5 KB)
  âœ… material_report_20241111_143022.json (38.7 KB)
```

### 7.2 æŸ¥çœ‹æ‰¹é‡åˆ†æç»“æœ

**æ‰§è¡Œå‘½ä»¤æŸ¥çœ‹ç»“æœ**:

```powershell
# è¯»å–å¹¶æ˜¾ç¤ºç»“æœæ‘˜è¦
python -c "
import json
from pathlib import Path

result_file = list(Path('test_results').glob('analysis_result_*.json'))[0]
with open(result_file, 'r', encoding='utf-8') as f:
    data = json.load(f)

print('=' * 60)
print('æ‰¹é‡åˆ†æç»“æœæ‘˜è¦')
print('=' * 60)
print(f'æ€»å›¾ç‰‡æ•°: {data[\"analysis\"][\"total_images\"]}')
print(f'æ€»æ ‡æ³¨æ•°: {data[\"analysis\"][\"total_annotations\"]}')
print(f'æ•´ä½“è´¨é‡: {data[\"recommendations\"][\"overall_quality\"]:.2f}%')
print(f'é«˜è´¨é‡å›¾ç‰‡æ•°: {len(data[\"recommendations\"][\"high_quality_images\"])}')

print('\nå¹³å‡ç»´åº¦å¾—åˆ†:')
for dim, score in data['analysis']['average_scores'].items():
    print(f'  {dim:20s}: {score:6.2f}%')

if data['recommendations']['needs_improvement']:
    print('\néœ€è¦æ”¹è¿›çš„ç»´åº¦:')
    for dim in data['recommendations']['needs_improvement']:
        print(f'  - {dim}')

print('=' * 60)
"
```

---

## ğŸŒ ç¬¬å…«æ­¥ï¼šå¯åŠ¨å’Œæµ‹è¯•Webç•Œé¢

### 8.1 å¯åŠ¨Webç•Œé¢

**æ‰§è¡Œå¯åŠ¨å‘½ä»¤**:

```powershell
# æ–¹å¼1: ä½¿ç”¨å¯åŠ¨è„šæœ¬
.\start_material_analyzer.ps1

# æ–¹å¼2: æ‰‹åŠ¨å¯åŠ¨ï¼ˆå¦‚æœè„šæœ¬ä¸å¯ç”¨ï¼‰
conda activate uav_adv
streamlit run app\web\material_analyzer_app.py --server.port 8502
```

**é¢„æœŸè¾“å‡º**:
```
ğŸš å¯åŠ¨æ— äººæœºç´ æ8ç»´åº¦åˆ†æç³»ç»Ÿ...
ğŸ“¦ æ¿€æ´»Condaç¯å¢ƒ...
ğŸ” æ£€æŸ¥ä¾èµ–...
âœ… åˆ›å»ºç›®å½•: reports
âœ… åˆ›å»ºç›®å½•: temp_uploads
ğŸŒ å¯åŠ¨Streamlitåº”ç”¨...
è®¿é—®åœ°å€: http://localhost:8502

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://192.168.x.x:8502
```

### 8.2 æ‰“å¼€Webç•Œé¢

**æ“ä½œæ­¥éª¤**:

1. **è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨**:
   - Streamlitå¯åŠ¨åä¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
   - å¦‚æœæ²¡æœ‰è‡ªåŠ¨æ‰“å¼€ï¼Œæ‰‹åŠ¨è®¿é—®: `http://localhost:8502`

2. **æˆ–è€…æ‰‹åŠ¨æ‰“å¼€**:
   ```powershell
   # åœ¨PowerShellä¸­æ‰§è¡Œ
   start http://localhost:8502
   ```

### 8.3 æµ‹è¯•Webç•Œé¢åŠŸèƒ½

**åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œä»¥ä¸‹æ“ä½œ**:

1. **æµ‹è¯•å•å›¾åˆ†æ**:
   - ç‚¹å‡»"å•å›¾åˆ†æ"æ ‡ç­¾é¡µ
   - ç‚¹å‡»"ä¸Šä¼ å›¾ç‰‡"æŒ‰é’®
   - é€‰æ‹© `test_images\test_single.jpg`
   - ç‚¹å‡»"å¼€å§‹åˆ†æ"æŒ‰é’®
   - ç­‰å¾…åˆ†æå®Œæˆ
   - æ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºé›·è¾¾å›¾å’Œå¾—åˆ†è¡¨

2. **æµ‹è¯•æ‰¹é‡åˆ†æ**:
   - ç‚¹å‡»"æ‰¹é‡åˆ†æ"æ ‡ç­¾é¡µ
   - ç‚¹å‡»"ä¸Šä¼ å¤šå¼ å›¾ç‰‡"æŒ‰é’®
   - é€‰æ‹© `test_images\batch\` ç›®å½•ä¸‹çš„æ‰€æœ‰å›¾ç‰‡
   - ç‚¹å‡»"å¼€å§‹æ‰¹é‡åˆ†æ"æŒ‰é’®
   - ç­‰å¾…åˆ†æå®Œæˆ
   - æ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºå¹³å‡é›·è¾¾å›¾ã€è´¨é‡è¡¨æ ¼ã€æ”¹è¿›å»ºè®®

3. **æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ**:
   - ç‚¹å‡»"ç»“æœæŠ¥å‘Š"æ ‡ç­¾é¡µ
   - ç‚¹å‡»"ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š"æŒ‰é’®
   - ç‚¹å‡»"ä¸‹è½½æŠ¥å‘Š"æŒ‰é’®
   - æ£€æŸ¥ä¸‹è½½çš„JSONæ–‡ä»¶

---

## ğŸ“Š ç¬¬ä¹æ­¥ï¼šä½¿ç”¨çœŸå®æ•°æ®æµ‹è¯•

### 9.1 å‡†å¤‡çœŸå®æ— äººæœºç´ æ

**æ‰§è¡Œå‘½ä»¤**:

```powershell
# åˆ›å»ºçœŸå®æ•°æ®ç›®å½•
if (-not (Test-Path "real_data_test")) {
    New-Item -ItemType Directory -Path "real_data_test" -Force | Out-Null
}

# æç¤ºç”¨æˆ·å¤åˆ¶çœŸå®æ•°æ®
Write-Host "è¯·å°†çœŸå®æ— äººæœºç´ æå¤åˆ¶åˆ°ä»¥ä¸‹ç›®å½•:" -ForegroundColor Yellow
Write-Host "  D:\mlflow_learning_project\real_data_test\" -ForegroundColor Cyan
Write-Host "`nå»ºè®®å‡†å¤‡20-50å¼ ä¸åŒè´¨é‡çš„å›¾ç‰‡" -ForegroundColor Yellow

# æ‰“å¼€ç›®å½•æ–¹ä¾¿å¤åˆ¶
explorer real_data_test

# ç­‰å¾…ç”¨æˆ·å¤åˆ¶å®Œæˆåï¼Œæ£€æŸ¥å›¾ç‰‡æ•°é‡
Write-Host "`næŒ‰ä»»æ„é”®ç»§ç»­ï¼ˆå¤åˆ¶å®Œå›¾ç‰‡åï¼‰..." -ForegroundColor Yellow
$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")

# æ£€æŸ¥å›¾ç‰‡æ•°é‡
$realImages = Get-ChildItem "real_data_test\*.jpg","real_data_test\*.jpeg","real_data_test\*.png" -ErrorAction SilentlyContinue
Write-Host "`næ‰¾åˆ° $($realImages.Count) å¼ å›¾ç‰‡" -ForegroundColor Cyan
```

### 9.2 æ‰§è¡ŒçœŸå®æ•°æ®åˆ†æ

**æ‰§è¡Œå‘½ä»¤**:

```powershell
# æ‰§è¡Œæ‰¹é‡åˆ†æ
Write-Host "`nå¼€å§‹çœŸå®æ•°æ®åˆ†æ..." -ForegroundColor Cyan
python scripts\batch_analyze.py `
  --input-dir "real_data_test" `
  --output-dir "real_data_results" `
  --min-quality 70

# æ˜¾ç¤ºç»“æœæ‘˜è¦
python -c "
import json
from pathlib import Path

result_file = list(Path('real_data_results').glob('analysis_result_*.json'))[0]
with open(result_file, 'r', encoding='utf-8') as f:
    data = json.load(f)

print('=' * 60)
print('çœŸå®æ•°æ®åˆ†æç»“æœ')
print('=' * 60)
print(f'æ€»å›¾ç‰‡æ•°: {data[\"analysis\"][\"total_images\"]}')
print(f'æ€»æ ‡æ³¨æ•°: {data[\"analysis\"][\"total_annotations\"]}')
print(f'æ•´ä½“è´¨é‡: {data[\"recommendations\"][\"overall_quality\"]:.2f}%')
print(f'é«˜è´¨é‡å›¾ç‰‡: {len(data[\"recommendations\"][\"high_quality_images\"])} å¼ ')
print(f'é«˜è´¨é‡æ¯”ä¾‹: {len(data[\"recommendations\"][\"high_quality_images\"]) / data[\"analysis\"][\"total_images\"] * 100:.1f}%')
print('=' * 60)
"
```

---

## âœ… ç¬¬åæ­¥ï¼šæœ€ç»ˆéªŒè¯å’ŒæŠ¥å‘Šç”Ÿæˆ

### 10.1 è¿è¡Œå®Œæ•´éªŒè¯è„šæœ¬

**æ‰§è¡Œå‘½ä»¤**:

```powershell
# åˆ›å»ºéªŒè¯è„šæœ¬
@"
import sys
sys.path.insert(0, '.')
from agents.image_quality_analyzer import ImageQualityAnalyzer
from agents.material_generator_agent import MaterialGeneratorAgent
from pathlib import Path
import json

print('=' * 60)
print('ç³»ç»Ÿå®Œæ•´éªŒè¯')
print('=' * 60)

# 1. éªŒè¯åˆ†æå™¨
print('1. éªŒè¯åˆ†æå™¨åˆå§‹åŒ–...')
try:
    analyzer = ImageQualityAnalyzer()
    print('   âœ… åˆ†æå™¨åˆå§‹åŒ–æˆåŠŸ')
except Exception as e:
    print(f'   âŒ åˆ†æå™¨åˆå§‹åŒ–å¤±è´¥: {e}')
    sys.exit(1)

# 2. éªŒè¯Agent
print('2. éªŒè¯Agentåˆå§‹åŒ–...')
try:
    agent = MaterialGeneratorAgent()
    print('   âœ… Agentåˆå§‹åŒ–æˆåŠŸ')
except Exception as e:
    print(f'   âŒ Agentåˆå§‹åŒ–å¤±è´¥: {e}')
    sys.exit(1)

# 3. éªŒè¯å•å›¾åˆ†æ
print('3. éªŒè¯å•å›¾åˆ†æ...')
test_image = Path('test_images') / list(Path('test_images').glob('*.jpg'))[0]
if test_image.exists():
    try:
        result = analyzer.analyze_single_image(str(test_image))
        if len(result) == 8:
            print('   âœ… å•å›¾åˆ†ææˆåŠŸï¼Œ8ä¸ªç»´åº¦éƒ½æœ‰è¾“å‡º')
        else:
            print(f'   âŒ ç»´åº¦æ•°é‡ä¸å¯¹: {len(result)}')
    except Exception as e:
        print(f'   âŒ å•å›¾åˆ†æå¤±è´¥: {e}')
else:
    print('   âš ï¸ æœªæ‰¾åˆ°æµ‹è¯•å›¾ç‰‡ï¼Œè·³è¿‡å•å›¾åˆ†ææµ‹è¯•')

# 4. éªŒè¯æ‰¹é‡åˆ†æ
print('4. éªŒè¯æ‰¹é‡åˆ†æ...')
batch_dir = Path('test_images/batch')
if batch_dir.exists() and list(batch_dir.glob('*.jpg')):
    try:
        image_paths = [str(p) for p in batch_dir.glob('*.jpg')]
        result = agent.analyze_and_evaluate(image_paths)
        if 'analysis' in result and 'recommendations' in result:
            print('   âœ… æ‰¹é‡åˆ†ææˆåŠŸ')
        else:
            print('   âŒ æ‰¹é‡åˆ†æç»“æœä¸å®Œæ•´')
    except Exception as e:
        print(f'   âŒ æ‰¹é‡åˆ†æå¤±è´¥: {e}')
else:
    print('   âš ï¸ æœªæ‰¾åˆ°æ‰¹é‡æµ‹è¯•å›¾ç‰‡ï¼Œè·³è¿‡æ‰¹é‡åˆ†ææµ‹è¯•')

# 5. éªŒè¯æ–‡ä»¶ç»“æ„
print('5. éªŒè¯æ–‡ä»¶ç»“æ„...')
required_dirs = ['agents', 'app/web', 'scripts', 'reports', 'test_images']
all_exist = all(Path(d).exists() for d in required_dirs)
if all_exist:
    print('   âœ… æ‰€æœ‰å¿…éœ€ç›®å½•éƒ½å­˜åœ¨')
else:
    missing = [d for d in required_dirs if not Path(d).exists()]
    print(f'   âŒ ç¼ºå¤±ç›®å½•: {missing}')

print('=' * 60)
print('âœ… ç³»ç»ŸéªŒè¯å®Œæˆ')
print('=' * 60)
"@ | python
```

### 10.2 ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š

**æ‰§è¡Œå‘½ä»¤**:

```powershell
# ç”Ÿæˆé¡¹ç›®å®ŒæˆæŠ¥å‘Š
$reportContent = @"
# ç¬¬6å‘¨å·¥ä½œå®ŒæˆæŠ¥å‘Š

## é¡¹ç›®ä¿¡æ¯
- é¡¹ç›®åç§°: æ— äººæœºç´ æ8ç»´åº¦æ™ºèƒ½åˆ†æAgentç³»ç»Ÿ
- å®Œæˆæ—¥æœŸ: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')
- å¼€å‘äººå‘˜: [å¡«å†™ä½ çš„åå­—]

## åŠŸèƒ½å®Œæˆæƒ…å†µ

### âœ… å·²å®ŒæˆåŠŸèƒ½
1. âœ… å•å›¾8ç»´åº¦åˆ†æ
2. âœ… æ‰¹é‡å›¾ç‰‡åˆ†æ
3. âœ… Webå¯è§†åŒ–ç•Œé¢
4. âœ… è´¨é‡è¯„ä¼°å’Œç­›é€‰
5. âœ… æ”¹è¿›å»ºè®®ç”Ÿæˆ
6. âœ… æŠ¥å‘Šå¯¼å‡ºåŠŸèƒ½

## æµ‹è¯•ç»“æœ

### å•å›¾åˆ†ææµ‹è¯•
- æµ‹è¯•å›¾ç‰‡æ•°é‡: $(if (Test-Path 'test_images\*.jpg') { (Get-ChildItem 'test_images\*.jpg').Count } else { 0 })
- åˆ†æé€Ÿåº¦: [å¡«å†™æµ‹è¯•ç»“æœ]ç§’/å¼ 
- åŠŸèƒ½çŠ¶æ€: âœ… æ­£å¸¸

### æ‰¹é‡åˆ†ææµ‹è¯•
- æµ‹è¯•å›¾ç‰‡æ•°é‡: $(if (Test-Path 'test_images\batch\*.jpg') { (Get-ChildItem 'test_images\batch\*.jpg').Count } else { 0 })
- åˆ†æé€Ÿåº¦: [å¡«å†™æµ‹è¯•ç»“æœ]ç§’/å¼ 
- åŠŸèƒ½çŠ¶æ€: âœ… æ­£å¸¸

### Webç•Œé¢æµ‹è¯•
- è®¿é—®åœ°å€: http://localhost:8502
- åŠŸèƒ½çŠ¶æ€: âœ… æ­£å¸¸

## 8ç»´åº¦åˆ†æèƒ½åŠ›

| ç»´åº¦ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| å›¾ç‰‡æ•°æ®é‡ | âœ… | åŸºäºåˆ†è¾¨ç‡å’Œæ–‡ä»¶å¤§å° |
| æ‹æ‘„å…‰ç…§è´¨é‡ | âœ… | åŸºäºäº®åº¦ã€å¯¹æ¯”åº¦ã€æ›å…‰ |
| ç›®æ ‡å°ºå¯¸ | âœ… | åŸºäºYOLOæ£€æµ‹ç»“æœ |
| ç›®æ ‡å®Œæ•´æ€§ | âœ… | æ£€æµ‹ç›®æ ‡æ˜¯å¦è¢«è£å‰ª |
| æ•°æ®å‡è¡¡åº¦ | âœ… | åŸºäºç±»åˆ«åˆ†å¸ƒ |
| äº§å“ä¸°å¯Œåº¦ | âœ… | åŸºäºç±»åˆ«æ•°é‡ |
| ç›®æ ‡å¯†é›†åº¦ | âœ… | åŸºäºå•ä½é¢ç§¯ç›®æ ‡æ•° |
| åœºæ™¯å¤æ‚åº¦ | âœ… | åŸºäºæ¸…æ™°åº¦ã€çº¹ç†ã€é¢œè‰² |

## æ€§èƒ½æŒ‡æ ‡

- å•å›¾åˆ†ææ—¶é—´: [å¡«å†™]ç§’ (ç›®æ ‡: <3ç§’) âœ…/âŒ
- æ‰¹é‡åˆ†æ(20å¼ )æ—¶é—´: [å¡«å†™]ç§’ (ç›®æ ‡: <60ç§’) âœ…/âŒ
- åˆ†æå‡†ç¡®ç‡: [å¡«å†™]% (ç›®æ ‡: >85%) âœ…/âŒ

## äº¤ä»˜ç‰©æ¸…å•

1. âœ… æ ¸å¿ƒä»£ç æ¨¡å— (agents/)
2. âœ… Webç•Œé¢ (app/web/)
3. âœ… æ‰¹é‡åˆ†æè„šæœ¬ (scripts/)
4. âœ… éƒ¨ç½²æ–‡æ¡£
5. âœ… æµ‹è¯•ç»“æœ

## ä½¿ç”¨è¯´æ˜

è¯¦ç»†ä½¿ç”¨è¯´æ˜è¯·å‚è€ƒ: ç¬¬6å‘¨å·¥ä½œéƒ¨ç½²æ–‡æ¡£_å®Œæ•´ç‰ˆ.md

---
æŠ¥å‘Šç”Ÿæˆæ—¶é—´: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')
"@

$reportContent | Out-File -FilePath "final_report\é¡¹ç›®å®ŒæˆæŠ¥å‘Š.md" -Encoding UTF8
Write-Host "âœ… é¡¹ç›®å®ŒæˆæŠ¥å‘Šå·²ç”Ÿæˆ: final_report\é¡¹ç›®å®ŒæˆæŠ¥å‘Š.md" -ForegroundColor Green

# æ‰“å¼€æŠ¥å‘Šæ–‡ä»¶
notepad "final_report\é¡¹ç›®å®ŒæˆæŠ¥å‘Š.md"
```

---

## ğŸ¯ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

### å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨

```powershell
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd D:\mlflow_learning_project

# 2. æ¿€æ´»ç¯å¢ƒ
conda activate uav_adv

# 3. å¯åŠ¨Webç•Œé¢
streamlit run app\web\material_analyzer_app.py --server.port 8502

# 4. å•å›¾åˆ†æ
python -c "from agents.image_quality_analyzer import ImageQualityAnalyzer; a = ImageQualityAnalyzer(); print(a.analyze_single_image('test_images/test_single.jpg'))"

# 5. æ‰¹é‡åˆ†æ
python scripts\batch_analyze.py --input-dir "test_images\batch" --output-dir "test_results" --min-quality 70

# 6. æŸ¥çœ‹ç›®å½•ç»“æ„
tree /F /A > directory_structure.txt

# 7. æ£€æŸ¥ä¾èµ–
python -c "import ultralytics, plotly, streamlit; print('æ‰€æœ‰ä¾èµ–OK')"
```

---

## ğŸ¨ ç¬¬åä¸€æ­¥ï¼šæ‰¹é‡ç”Ÿæˆé«˜è´¨é‡æ— äººæœºç´ æ

### 11.1 å‡†å¤‡æºç´ æç›®å½•

**æ“ä½œæ­¥éª¤**:
1. å‡†å¤‡åŒ…å«å¤§é‡æ— äººæœºå›¾ç‰‡çš„æºç›®å½•
2. å›¾ç‰‡æ ¼å¼æ”¯æŒ: .jpg, .jpeg, .png, .bmp

**æ‰§è¡Œå‘½ä»¤**:

```powershell
# åˆ›å»ºæºç´ æç›®å½•ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
if (-not (Test-Path "source_materials")) {
    New-Item -ItemType Directory -Path "source_materials" -Force | Out-Null
    Write-Host "âœ… åˆ›å»ºæºç´ æç›®å½•: source_materials" -ForegroundColor Green
}

# æç¤ºç”¨æˆ·å¤åˆ¶ç´ æ
Write-Host "`nè¯·å°†å¾…ç­›é€‰çš„æ— äººæœºå›¾ç‰‡å¤åˆ¶åˆ°ä»¥ä¸‹ç›®å½•:" -ForegroundColor Yellow
Write-Host "  D:\mlflow_learning_project\source_materials\" -ForegroundColor Cyan
Write-Host "`nå»ºè®®å‡†å¤‡50-200å¼ ä¸åŒè´¨é‡çš„å›¾ç‰‡" -ForegroundColor Yellow

# æ‰“å¼€ç›®å½•æ–¹ä¾¿å¤åˆ¶
explorer source_materials

# ç­‰å¾…ç”¨æˆ·å¤åˆ¶å®Œæˆåï¼Œæ£€æŸ¥å›¾ç‰‡æ•°é‡
Write-Host "`næŒ‰ä»»æ„é”®ç»§ç»­ï¼ˆå¤åˆ¶å®Œå›¾ç‰‡åï¼‰..." -ForegroundColor Yellow
$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")

# æ£€æŸ¥å›¾ç‰‡æ•°é‡
$sourceImages = Get-ChildItem "source_materials\*.jpg","source_materials\*.jpeg","source_materials\*.png" -ErrorAction SilentlyContinue
Write-Host "`næ‰¾åˆ° $($sourceImages.Count) å¼ å›¾ç‰‡" -ForegroundColor Cyan
```

### 11.2 æ‰§è¡Œæ‰¹é‡ç´ æç”Ÿæˆ

**æ‰§è¡Œå‘½ä»¤**:

```powershell
# åˆ›å»ºè¾“å‡ºç›®å½•
if (-not (Test-Path "generated_materials")) {
    New-Item -ItemType Directory -Path "generated_materials" -Force | Out-Null
}

Write-Host "`nå¼€å§‹æ‰¹é‡ç”Ÿæˆé«˜è´¨é‡ç´ æ..." -ForegroundColor Cyan
Write-Host "=" * 60 -ForegroundColor Cyan

# æ‰§è¡Œæ‰¹é‡ç”Ÿæˆï¼ˆæœ€ä½è´¨é‡75%ï¼Œæœ€å¤šç”Ÿæˆ50å¼ ï¼‰
python scripts\generate_materials.py `
  --source-dir "source_materials" `
  --output-dir "generated_materials" `
  --min-quality 75.0 `
  --max-count 50 `
  --generate-report

Write-Host "`næ£€æŸ¥ç”Ÿæˆç»“æœ..." -ForegroundColor Cyan
if (Test-Path "generated_materials") {
    $generatedImages = Get-ChildItem "generated_materials\high_quality_*.jpg","generated_materials\high_quality_*.png" -ErrorAction SilentlyContinue
    Write-Host "âœ… ç”Ÿæˆé«˜è´¨é‡ç´ æ: $($generatedImages.Count) å¼ " -ForegroundColor Green
    
    # æ˜¾ç¤ºç”Ÿæˆçš„æ–‡ä»¶
    Get-ChildItem "generated_materials\*" | Select-Object Name, Length, LastWriteTime | Format-Table -AutoSize
}
```

**é¢„æœŸè¾“å‡º**:
```
============================================================
æ— äººæœºç´ ææ‰¹é‡ç”Ÿæˆå™¨
============================================================
æºç›®å½•: source_materials
è¾“å‡ºç›®å½•: generated_materials
æœ€ä½è´¨é‡: 75.0%
æœ€å¤§æ•°é‡: 50
============================================================
ğŸ“¸ æ‰¾åˆ° 100 å¼ å›¾ç‰‡ï¼Œå¼€å§‹åˆ†æ...
æ­£åœ¨åˆå§‹åŒ–åˆ†æå™¨...
æ­£åœ¨åˆ†æå›¾ç‰‡ 1/100...
æ­£åœ¨åˆ†æå›¾ç‰‡ 2/100...
...
âœ… [1/35] image_001.jpg (è´¨é‡: 92.35%)
âœ… [2/35] image_045.jpg (è´¨é‡: 88.67%)
...
============================================================
âœ… ç´ æç”Ÿæˆå®Œæˆï¼
============================================================
åˆ†æå›¾ç‰‡æ€»æ•°: 100
ç”Ÿæˆé«˜è´¨é‡ç´ æ: 35 å¼ 
ç”Ÿæˆç‡: 35.00%

è¾“å‡ºç›®å½•: generated_materials
å…ƒæ•°æ®æ–‡ä»¶: generated_materials\material_metadata_20241111_143022.json
ç»Ÿè®¡æ–‡ä»¶: generated_materials\generation_statistics_20241111_143022.json

æ­£åœ¨ç”ŸæˆæŠ¥å‘Š...
âœ… æŠ¥å‘Šå·²ç”Ÿæˆ: generated_materials\material_generation_report_20241111_143022.md
```

### 11.3 æŸ¥çœ‹ç”Ÿæˆç»“æœ

**æ‰§è¡Œå‘½ä»¤æŸ¥çœ‹ç”ŸæˆæŠ¥å‘Š**:

```powershell
# æŸ¥æ‰¾æœ€æ–°çš„æŠ¥å‘Šæ–‡ä»¶
$reportFile = Get-ChildItem "generated_materials\material_generation_report_*.md" | 
    Sort-Object LastWriteTime -Descending | 
    Select-Object -First 1

if ($reportFile) {
    Write-Host "`næ‰“å¼€ç”ŸæˆæŠ¥å‘Š..." -ForegroundColor Cyan
    notepad $reportFile.FullName
    
    # æ˜¾ç¤ºæŠ¥å‘Šæ‘˜è¦
    Write-Host "`næŠ¥å‘Šæ‘˜è¦:" -ForegroundColor Yellow
    Get-Content $reportFile.FullName -Head 20
}
```

### 11.4 éªŒè¯ç”Ÿæˆçš„ç´ æ

**æ‰§è¡Œå‘½ä»¤**:

```powershell
# ç»Ÿè®¡ç”Ÿæˆç»“æœ
python -c "
import json
from pathlib import Path

# è¯»å–å…ƒæ•°æ®
metadata_file = list(Path('generated_materials').glob('material_metadata_*.json'))[0]
with open(metadata_file, 'r', encoding='utf-8') as f:
    data = json.load(f)

print('=' * 60)
print('ç´ æç”Ÿæˆç»Ÿè®¡')
print('=' * 60)
print(f'åˆ†æå›¾ç‰‡æ€»æ•°: {data[\"total_analyzed\"]}')
print(f'ç”Ÿæˆé«˜è´¨é‡ç´ æ: {data[\"generated_count\"]} å¼ ')
print(f'ç”Ÿæˆç‡: {data[\"generated_count\"] / data[\"total_analyzed\"] * 100:.2f}%')
print(f'æœ€ä½è´¨é‡è¦æ±‚: {data[\"min_quality\"]}%')

# è´¨é‡åˆ†å¸ƒ
scores = [m['quality_score'] for m in data['materials']]
print(f'\nè´¨é‡åˆ†å¸ƒ:')
print(f'  ä¼˜ç§€ (>=90%): {sum(1 for s in scores if s >= 90)} å¼ ')
print(f'  è‰¯å¥½ (80-89%): {sum(1 for s in scores if 80 <= s < 90)} å¼ ')
print(f'  ä¸­ç­‰ (70-79%): {sum(1 for s in scores if 70 <= s < 80)} å¼ ')

print('=' * 60)
"
```

### 11.5 é«˜çº§é€‰é¡¹ï¼šè‡ªå®šä¹‰ç»´åº¦æƒé‡

**å¦‚æœéœ€è¦è‡ªå®šä¹‰è¯„åˆ†æƒé‡ï¼Œæ‰§è¡Œ**:

```powershell
# åˆ›å»ºè‡ªå®šä¹‰æƒé‡é…ç½®
$weightsConfig = @{
    "å›¾ç‰‡æ•°æ®é‡" = 0.15
    "æ‹æ‘„å…‰ç…§è´¨é‡" = 0.20
    "ç›®æ ‡å°ºå¯¸" = 0.15
    "ç›®æ ‡å®Œæ•´æ€§" = 0.15
    "æ•°æ®å‡è¡¡åº¦" = 0.10
    "äº§å“ä¸°å¯Œåº¦" = 0.10
    "ç›®æ ‡å¯†é›†åº¦" = 0.10
    "åœºæ™¯å¤æ‚åº¦" = 0.05
} | ConvertTo-Json

$weightsConfig | Out-File -FilePath "dimension_weights.json" -Encoding UTF8
Write-Host "âœ… æƒé‡é…ç½®å·²ä¿å­˜: dimension_weights.json" -ForegroundColor Green
```

### 11.6 æ‰¹é‡ç”Ÿæˆå®Œæ•´æµç¨‹ç¤ºä¾‹

**å®Œæ•´çš„ä¸€é”®ç”Ÿæˆå‘½ä»¤**:

```powershell
# å®Œæ•´æµç¨‹ï¼šä»æºç›®å½•ç”Ÿæˆé«˜è´¨é‡ç´ æ
Write-Host "`n=== æ— äººæœºç´ ææ‰¹é‡ç”Ÿæˆå®Œæ•´æµç¨‹ ===" -ForegroundColor Cyan

# 1. æ£€æŸ¥æºç›®å½•
$sourceDir = "source_materials"
if (-not (Test-Path $sourceDir) -or (Get-ChildItem "$sourceDir\*.jpg","$sourceDir\*.png" -ErrorAction SilentlyContinue).Count -eq 0) {
    Write-Host "âŒ æºç›®å½•ä¸å­˜åœ¨æˆ–æ²¡æœ‰å›¾ç‰‡ï¼Œè¯·å…ˆå‡†å¤‡ç´ æ" -ForegroundColor Red
    exit
}

# 2. æ‰§è¡Œç”Ÿæˆ
python scripts\generate_materials.py `
  --source-dir $sourceDir `
  --output-dir "generated_materials" `
  --min-quality 75.0 `
  --max-count 50 `
  --generate-report

# 3. æ‰“å¼€ç»“æœç›®å½•
explorer generated_materials

Write-Host "`nâœ… ç´ æç”Ÿæˆå®Œæˆï¼" -ForegroundColor Green
Write-Host "ç”Ÿæˆçš„é«˜è´¨é‡ç´ æå·²ä¿å­˜åˆ°: generated_materials\" -ForegroundColor Cyan
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ‰€æœ‰å‘½ä»¤éƒ½åœ¨PowerShellä¸­æ‰§è¡Œ**
2. **ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½• `D:\mlflow_learning_project` æ‰§è¡Œå‘½ä»¤**
3. **ç¡®ä¿Condaç¯å¢ƒå·²æ¿€æ´» `(uav_adv)`**
4. **å¦‚æœå‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œæ£€æŸ¥é”™è¯¯ä¿¡æ¯å¹¶å‚è€ƒè§£å†³æ–¹æ¡ˆ**
5. **é¦–æ¬¡è¿è¡ŒYOLOä¼šä¸‹è½½æ¨¡å‹ï¼Œéœ€è¦ç½‘ç»œè¿æ¥**
6. **ç´ æç”Ÿæˆéœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œå–å†³äºæºå›¾ç‰‡æ•°é‡ï¼ˆæ¯å¼ çº¦2-5ç§’ï¼‰**

---

**æ–‡æ¡£ç‰ˆæœ¬**: v3.1 (å®Œæ•´è¯¦ç»†ç‰ˆ - åŒ…å«ç´ æç”ŸæˆåŠŸèƒ½)  
**åˆ›å»ºæ—¥æœŸ**: 2024å¹´11æœˆ  
**æœ€åæ›´æ–°**: 2024å¹´11æœˆ

