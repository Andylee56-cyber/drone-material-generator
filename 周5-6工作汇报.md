# 周5-6 VisDrone YOLOv8 项目工作汇报

## 1. 项目概览
- **目标**：完成 VisDrone 数据集基线检测模型的训练、验证与可视化，形成可复现的周 5-6 工作成果。
- **模型**：Ultralytics YOLOv8n（预训练权重）。
- **环境**：`conda` 虚拟环境 `visdrone_yolov8`，Python 3.10，CPU/GPU 双支持（根据硬件自动切换）。
- **交付物**：
  - 训练日志与模型权重：`runs/train/yolov8n_visdrone2`
  - 验证结果：`runs/val/yolov8n_visdrone2`
  - 推理可视化：`runs/predict/visdrone_val_samples`

## 2. 环境与目录
- 目录根路径：`D:\AIProjects\VisDrone_YOLOv8`
- 关键组件安装：
  - `conda create -n visdrone_yolov8 python=3.10`
  - `pip install ultralytics opencv-python tqdm`
- 训练脚本调用工具：`yolo.exe`（Ultralytics CLI）

## 3. 数据集处理
1. 下载并解压 VisDrone 数据集至 `data/raw/VisDrone2019`.
2. 利用脚本 `scripts\visdrone_to_yolo.py` 转换为 YOLO TXT 标注，输出至 `data/yolo/{train,val,test}`。
3. 生成数据配置文件 `data/yolo/visdrone.yaml`。

> 截图位：数据目录结构  
> `![图1 数据目录结构](./images/placeholder_data_structure.png)`

## 4. 模型训练
- 命令：
  ```powershell
  Set-Location D:\AIProjects\VisDrone_YOLOv8
  conda activate visdrone_yolov8

  yolo detect train `
      model=yolov8n.pt `
      data=data/yolo/visdrone.yaml `
      epochs=50 `
      imgsz=960 `
      batch=8 `
      workers=2 `
      mosaic=0.5 `
      cache=False `
      project=runs/train `
      name=yolov8n_visdrone2 `
      pretrained=True
  ```
- 调整说明：为规避 DataLoader 内存不足，将 `workers` 降为 2、`mosaic` 降为 0.5、关闭 `cache`。
- 训练全程完成 50 epoch，生成 `best.pt` 与 `last.pt` 权重。

> 截图位：训练完成日志  
> `![图2 训练日志](./runs/train/yolov8n_visdrone2/results.png)`

## 5. 验证结果
- 命令：
  ```powershell
  yolo detect val `
      model=runs/train/yolov8n_visdrone2/weights/best.pt `
      data=data/yolo/visdrone.yaml `
      imgsz=960 `
      project=runs/val `
      name=yolov8n_visdrone2
  ```
- 指标（验证集整体）：
  - Precision：0.452
  - Recall：0.259
  - mAP@0.5：0.244
  - mAP@0.5:0.95：0.126
- 日志中提示部分标注越界（忽略处理），不影响整体评估。

> 截图位：验证指标表  
> `![图3 验证结果](./images/placeholder_val_metrics.png)`

## 6. 推理可视化
- 命令：
  ```powershell
  yolo detect predict `
      model=runs/train/yolov8n_visdrone2/weights/best.pt `
      source=data/yolo/val/images `
      imgsz=960 `
      save=True `
      save_txt=True `
      conf=0.25 `
      project=runs/predict `
      name=visdrone_val_samples
  ```
- 输出：
  - 可视化图片：`runs/predict/visdrone_val_samples/*.jpg`
  - 推理 TXT：`runs/predict/visdrone_val_samples/labels/*.txt`
- 示例说明：模型对街道场景中的车辆、行人等目标进行了多类别检测，置信度范围 0.3~0.96，与预期一致。

> 截图位：样例推理图  
> `![图4 推理样例](./runs/predict/visdrone_val_samples/0000007_01234_d_0000015.jpg)`

## 7. 问题与解决
- **问题**：初次训练出现 `cv2::OutOfMemoryError`。  
  **解决**：降低 `workers`、`mosaic`，关闭 `cache`，必要时可再降低 `batch` 或 `imgsz`。
- **问题**：部分标注越界警告。  
  **解决**：由数据集自身标注导致，YOLO 自动忽略，对训练/验证影响可忽略。
- **问题**：Cursor 对话框偶发不显示图片。  
  **解决**：人工在文件系统中直接打开图片验证生成成功。

## 8. 后续计划与建议
- 继续调参与扩展：
  - 增加训练 epoch 或使用 `yolov8m` 以上模型提升精度。
  - 尝试 `augmentation=mosaic=1.0`、`imgsz=1280` 等组合，在内存允许前提下探索精度上限。
- 整理成果：
  - 将 `best.pt`、验证日志、推理样例整理至 `deliverables/week5-6/`。
  - 在项目文档中补充截图与指标，支撑周会汇报。
- 可选拓展：
  - 导出 ONNX/TensorRT 供部署测试。
  - 结合 Streamlit 或自研 UI 展示实时检测效果。

---

> 汇报人：  
> 时间：2025 年 xx 月 xx 日  
> 备注：上方图片路径为占位，请在提交前替换为实际截图位置。

